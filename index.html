<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Cvapta Frog</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #007241;
      --primary-dark: #005633;
      --primary-light: #00884f;
      --secondary: #3498db;
      --accent: #9b59b6;
      --danger: #e74c3c;
      --warning: #f39c12;
      --disabled: #95a5a6;
      --pink: #e91e63;
      --pink-dark: #c2185b;
      --pink-light: #f06292;
      
      --glass-bg: rgba(255, 255, 255, 0.08);
      --glass-border: rgba(255, 255, 255, 0.12);
      --glass-bg-light: rgba(255, 255, 255, 0.05);
      --glass-border-light: rgba(255, 255, 255, 0.08);
      
      --text-light: #ffffff;
      --text-muted: #b0b0b0;
      --text-dark: #2c3e50;
      --bg-dark: linear-gradient(135deg, #1a1f2e 0%, #2d3748 100%);
      --bg-light: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      --bg-pink: linear-gradient(135deg, #4a1e35 0%, #6d2c50 100%);
      --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      --hover-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
      
      /* Animation speeds */
      --anim-slow: 0.6s;
      --anim-medium: 0.4s;
      --anim-fast: 0.2s;
      --anim-very-slow: 0.8s;
    }
    
    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
      -webkit-tap-highlight-color: transparent; 
      user-select: none; 
      -webkit-user-drag: none; 
      touch-action: manipulation;
    }
    
    body { 
      height: 100vh; 
      overflow: hidden; 
      display: flex; 
      flex-direction: column; 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; 
      position: relative;
      background: var(--bg-dark);
      color: var(--text-light);
      transition: all var(--anim-slow) cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    body.animations-disabled * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
    
    body.animations-disabled .frog {
      animation: none !important;
    }
    
    body.animations-disabled .click-effect,
    body.animations-disabled .floating-text,
    body.animations-disabled .glass-modal.active,
    body.animations-disabled .glass-modal.active .glass-content,
    body.animations-disabled .stars-notification.show,
    body.animations-disabled .toast.show,
    body.animations-disabled .stars-card,
    body.animations-disabled .more-item,
    body.animations-disabled .stat-card,
    body.animations-disabled .receipt-row,
    body.animations-disabled .receipt-footer,
    body.animations-disabled .receipt-close-container,
    body.animations-disabled .stars-history-item,
    body.animations-disabled .settings-group,
    body.animations-disabled .stars-card,
    body.animations-disabled .anti-cheat-overlay.active,
    body.animations-disabled .stats-chart,
    body.animations-disabled .chart-bar-container,
    body.animations-disabled .click-session-item {
      animation: none !important;
      transition: none !important;
      opacity: 1 !important;
      transform: none !important;
    }
    
    body.light-theme { 
      background: var(--bg-light); 
      color: var(--text-dark);
      --glass-bg: rgba(255, 255, 255, 0.7);
      --glass-border: rgba(0, 0, 0, 0.1);
      --glass-bg-light: rgba(255, 255, 255, 0.5);
      --glass-border-light: rgba(0, 0, 0, 0.08);
      --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      --hover-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }
    
    body.pink-theme { 
      background: var(--bg-pink); 
      color: var(--text-light);
      --primary: #e91e63;
      --primary-dark: #c2185b;
      --primary-light: #f06292;
      --glass-bg: rgba(255, 255, 255, 0.1);
      --glass-border: rgba(255, 255, 255, 0.15);
      --glass-bg-light: rgba(255, 255, 255, 0.07);
      --glass-border-light: rgba(255, 255, 255, 0.1);
      --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      --hover-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    }
    
    .anti-cheat-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, #8b4513, #a0522d);
      z-index: 10000;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(20px);
      transition: all var(--anim-medium) ease;
      opacity: 0;
      transform: scale(0.95);
    }

    .anti-cheat-overlay.active {
      display: flex;
      animation: alarmPulse 0.5s infinite alternate, fadeInScale 0.3s ease forwards;
    }

    @keyframes alarmPulse {
      0% { background: linear-gradient(45deg, #8b4513, #a0522d); }
      100% { background: linear-gradient(45deg, #a0522d, #8b4513); }
    }

    @keyframes fadeInScale {
      0% { opacity: 0; transform: scale(0.95); }
      100% { opacity: 1; transform: scale(1); }
    }

    .anti-cheat-message {
      font-size: 24px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 20px;
      text-shadow: 0 2px 10px rgba(0,0,0,0.5);
      color: #fff;
      animation: textShake 0.5s infinite alternate;
    }

    @keyframes textShake {
      0% { transform: translateX(0); }
      100% { transform: translateX(5px); }
    }

    .cheater-detected {
      font-size: 32px;
      color: white;
      font-weight: 900;
      text-align: center;
      margin-bottom: 20px;
      animation: pulseRed 0.5s infinite alternate;
    }

    @keyframes pulseRed {
      0% { transform: scale(1); text-shadow: 0 0 10px rgba(255,0,0,0.5); }
      100% { transform: scale(1.05); text-shadow: 0 0 20px rgba(255,0,0,0.8); }
    }

    .ban-timer {
      font-size: 20px;
      color: white;
      text-align: center;
      animation: fadeInOut 2s infinite alternate;
    }

    @keyframes fadeInOut {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }
    
    .main-content { 
      flex: 1; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center; 
      padding: 10px 16px;
      position: relative;
    }
    
    .click-count { 
      font-size: clamp(32px, 10vw, 48px);
      font-weight: 700; 
      margin-bottom: 15px; 
      background: var(--glass-bg);
      backdrop-filter: blur(12px) saturate(180%);
      padding: 16px 28px;
      border-radius: 20px; 
      border: 1px solid var(--glass-border);
      color: var(--text-light); 
      box-shadow: var(--card-shadow); 
      text-align: center;
      width: min(90%, 320px);
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1);
      line-height: 1.1;
    }
    
    .frog-container { 
      position: relative; 
      margin: 10px 0 20px; 
    }
    
    .frog { 
      width: min(280px, 70vw); 
      height: min(280px, 70vw); 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      cursor: pointer; 
      font-size: min(160px, 40vw); 
      animation: breathe 4s infinite ease-in-out; 
      position: relative;
      z-index: 2;
      transition: transform var(--anim-fast) ease;
      filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2));
      will-change: transform;
    }
    
    @keyframes breathe { 
      0%, 100% { transform: scale(1); } 
      50% { transform: scale(1.04); } 
    }
    
    .frog:active { 
      transform: scale(0.94); 
    }

    .frog.night-mode {
      opacity: 0.5;
      cursor: not-allowed !important;
      filter: brightness(0.7) grayscale(0.3);
      animation: none !important;
    }

    .click-effect { 
      position: absolute; 
      width: 80px; 
      height: 80px; 
      background: radial-gradient(circle, rgba(0, 114, 65, 0.4) 0%, transparent 70%); 
      border-radius: 50%; 
      pointer-events: none; 
      animation: ripple 0.4s ease-out, fadeOut 0.4s ease-out forwards; 
      z-index: 3;
    }
    
    @keyframes ripple { 
      0% { transform: scale(0.3); opacity: 1; } 
      100% { transform: scale(2.5); opacity: 0; } 
    }
    
    @keyframes fadeOut {
      0% { opacity: 1; }
      100% { opacity: 0; }
    }
    
    .floating-text { 
      position: absolute; 
      color: var(--primary-light); 
      font-weight: 700; 
      font-size: clamp(20px, 6vw, 28px); 
      pointer-events: none; 
      animation: floatUp 0.8s ease-out forwards; 
      z-index: 4;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    
    @keyframes floatUp { 
      0% { transform: translateY(0) scale(1); opacity: 1; } 
      100% { transform: translateY(-100px) scale(1.2); opacity: 0; }
    }
    
    .bottom-nav { 
      display: flex; 
      justify-content: space-around; 
      background: var(--glass-bg);
      backdrop-filter: blur(15px) saturate(180%);
      border-top: 1px solid var(--glass-border); 
      padding: 12px 0; 
      height: 70px; 
      z-index: 10;
      margin: 0 12px 8px;
      border-radius: 20px;
      box-shadow: var(--card-shadow);
      transition: all var(--anim-medium) ease;
    }
    
    .nav-item { 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      font-size: 11px; 
      color: var(--text-light); 
      opacity: 0.8;
      cursor: pointer; 
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1); 
      flex: 1; 
      padding: 4px;
      border-radius: 12px;
    }
    
    .nav-item:hover {
      opacity: 1;
      transform: translateY(-2px);
    }
    
    .nav-item.active { 
      color: var(--primary); 
      opacity: 1;
    }
    
    .nav-icon { 
      font-size: 16px; 
      margin-bottom: 4px; 
      width: 40px; 
      height: 40px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      border-radius: 12px; 
      background: var(--glass-bg-light);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border-light);
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1); 
    }
    
    .nav-item.active .nav-icon { 
      background: var(--primary); 
      color: white; 
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0, 114, 65, 0.3);
    }
    
    .glass-modal { 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      background: rgba(0,0,0,0.5); 
      display: none; 
      align-items: center; 
      justify-content: center; 
      opacity: 0; 
      pointer-events: none; 
      transition: opacity var(--anim-medium) ease; 
      z-index: 1000; 
      padding: 16px;
      backdrop-filter: blur(5px);
    }
    
    .glass-modal.active { 
      display: flex;
      opacity: 1; 
      pointer-events: all; 
      animation: modalFadeIn 0.3s ease;
    }
    
    .glass-modal.closing {
      opacity: 0;
      transition: opacity var(--anim-medium) ease;
    }
    
    @keyframes modalFadeIn {
      0% { opacity: 0; backdrop-filter: blur(0); }
      100% { opacity: 1; backdrop-filter: blur(5px); }
    }
    
    .glass-content {
      width: min(360px, 94vw);
      max-height: 80vh;
      border-radius: 24px;
      background: rgba(30, 35, 48, 0.85);
      backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid var(--glass-border);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      transform: translateY(20px) scale(0.98);
      transition: transform var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .glass-modal.active .glass-content {
      transform: translateY(0) scale(1);
      animation: contentSlideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    @keyframes contentSlideIn {
      0% { transform: translateY(50px) scale(0.95); opacity: 0; }
      100% { transform: translateY(0) scale(1); opacity: 1; }
    }
    
    .glass-modal.closing .glass-content {
      transform: translateY(20px) scale(0.98);
      opacity: 0;
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .stars-card {
      background: rgba(0, 0, 0, 0.4);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 15px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      transition: all var(--anim-medium) ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      opacity: 0;
      animation: itemFadeIn 0.3s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.1s);
    }
    
    .stars-card:hover:not(.locked) {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 8px 25px rgba(0, 114, 65, 0.3);
    }
    
    .stars-card.unlocked {
      background: rgba(0, 114, 65, 0.25);
      border-color: rgba(0, 114, 65, 0.5);
      box-shadow: 0 4px 20px rgba(0, 114, 65, 0.2);
    }
    
    .stars-card.locked {
      opacity: 0.6;
      filter: grayscale(0.5);
      cursor: not-allowed;
    }
    
    .stars-reward {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }
    
    .stars-reward-info {
      flex: 1;
    }
    
    .stars-reward-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 5px;
      color: #fff;
    }
    
    .stars-reward-desc {
      font-size: 14px;
      opacity: 0.9;
      color: #ddd;
    }
    
    .stars-reward-icon {
      font-size: 24px;
      color: #f39c12;
      margin-left: 15px;
    }
    
    .stars-reward-amount {
      font-size: 20px;
      font-weight: 700;
      color: #f39c12;
      background: rgba(243, 156, 18, 0.15);
      padding: 8px 16px;
      border-radius: 12px;
      min-width: 80px;
      text-align: center;
      border: 1px solid rgba(243, 156, 18, 0.3);
    }
    
    .stars-progress {
      height: 6px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 3px;
      overflow: hidden;
      margin: 10px 0;
    }
    
    .stars-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #f39c12, #f1c40f);
      border-radius: 3px;
      transition: width 0.5s ease;
    }
    
    .stars-progress-text {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      opacity: 0.9;
      margin-top: 5px;
      color: #ccc;
    }
    
    .stars-notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(-100px);
      background: linear-gradient(135deg, rgba(243, 156, 18, 0.9), rgba(230, 126, 34, 0.9));
      backdrop-filter: blur(20px);
      color: white;
      padding: 16px 20px;
      border-radius: 16px;
      z-index: 1001;
      box-shadow: 0 10px 30px rgba(243, 156, 18, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
      max-width: 90%;
      width: 350px;
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      text-align: center;
    }
    
    .stars-notification.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
      animation: notificationSlide 0.5s ease-out;
    }
    
    @keyframes notificationSlide {
      0% { transform: translateX(-50%) translateY(-100px); opacity: 0; }
      100% { transform: translateX(-50%) translateY(0); opacity: 1; }
    }
    
    .stars-notification-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }
    
    .stars-notification-icon {
      font-size: 32px;
      color: white;
    }
    
    .stars-notification-text {
      font-size: 15px;
      font-weight: 600;
      line-height: 1.4;
    }
    
    .stars-notification-stars {
      font-size: 24px;
      font-weight: 700;
      color: white;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }
    
    .stars-notification-btn {
      background: white;
      color: #f39c12;
      border: none;
      padding: 10px 24px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      width: 100%;
      margin-top: 8px;
    }
    
    .stars-notification-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    
    .stars-notification-btn:active {
      transform: translateY(0);
    }
    
    .stars-notification-close {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 14px;
      transition: all var(--anim-fast) ease;
    }
    
    .stars-notification-close:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .warning-modal {
      background: #000 !important;
    }
    
    .warning-modal .glass-content {
      background: #000 !important;
      border: none;
      box-shadow: none;
    }
    
    .warning-content {
      text-align: center;
      padding: 30px;
      background: rgba(0, 0, 0, 0.9);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      max-width: 500px;
      margin: 0 auto;
    }
    
    .warning-icon {
      font-size: 60px;
      color: #f39c12;
      margin-bottom: 20px;
    }
    
    .warning-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 20px;
      color: #fff;
    }
    
    .warning-text {
      font-size: 16px;
      margin-bottom: 30px;
      line-height: 1.5;
      opacity: 0.9;
      color: #ccc;
    }
    
    .warning-timer {
      font-size: 14px;
      color: #f39c12;
      margin-top: 20px;
      font-weight: 600;
      animation: timerPulse 1s infinite alternate;
    }
    
    @keyframes timerPulse {
      0% { opacity: 0.7; }
      100% { opacity: 1; }
    }
    
    .warning-buttons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .warning-btn {
      padding: 15px 30px;
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--anim-medium) ease;
      opacity: 0.5;
      pointer-events: none;
      flex: 1;
      transform: scale(0.95);
    }
    
    .warning-btn.active {
      opacity: 1;
      pointer-events: all;
      transform: scale(1);
    }
    
    .warning-btn-cancel {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      opacity: 1;
      pointer-events: all;
      transform: scale(1);
    }
    
    .warning-btn-cancel:hover {
      background: linear-gradient(135deg, #c0392b, #a93226);
      transform: translateY(-2px);
    }

    .receipt-modal .glass-content {
      background: #000 !important;
      border: none;
      box-shadow: none;
    }
    
    .receipt-container {
      background: white;
      color: #000;
      padding: 25px 20px;
      border-radius: 16px;
      width: 100%;
      max-width: 95vw;
      max-height: 85vh;
      margin: 0 auto;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      font-family: 'Courier New', monospace;
      position: relative;
      overflow-y: auto;
      animation: receiptFadeIn 0.5s ease-out;
    }
    
    @keyframes receiptFadeIn {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    .receipt-header {
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 2px dashed #000;
    }
    
    .receipt-title {
      font-size: clamp(20px, 5vw, 24px);
      font-weight: bold;
      margin-bottom: 8px;
      color: #000;
    }
    
    .receipt-subtitle {
      font-size: clamp(13px, 3.5vw, 14px);
      opacity: 0.8;
      color: #000;
    }
    
    .receipt-details {
      margin-bottom: 25px;
    }
    
    .receipt-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed #ccc;
      color: #000;
      font-size: clamp(13px, 3.5vw, 14px);
      opacity: 0;
      animation: rowFadeIn 0.3s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.05s + 0.2s);
    }
    
    @keyframes rowFadeIn {
      100% { opacity: 1; }
    }
    
    .receipt-row.total {
      font-weight: bold;
      border-top: 2px solid #000;
      border-bottom: none;
      margin-top: 15px;
      padding-top: 12px;
      color: #000;
    }
    
    .receipt-row.warning {
      color: #e74c3c;
      font-weight: bold;
    }
    
    .receipt-footer {
      text-align: center;
      margin-top: 25px;
      padding-top: 20px;
      border-top: 2px dashed #000;
      font-size: clamp(11px, 3vw, 12px);
      color: #000;
      opacity: 0;
      animation: fadeIn 0.5s ease-out 0.8s forwards;
    }
    
    @keyframes fadeIn {
      100% { opacity: 1; }
    }
    
    .receipt-close-container {
      text-align: center;
      margin-top: 25px;
      opacity: 0;
      animation: fadeIn 0.5s ease-out 0.9s forwards;
    }
    
    .receipt-close-btn {
      padding: 14px 40px;
      background: linear-gradient(135deg, #9b59b6, #8e44ad);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      opacity: 0.5;
      pointer-events: none;
      width: auto;
      min-width: 200px;
    }
    
    .receipt-close-btn.active {
      opacity: 1;
      pointer-events: all;
    }
    
    .receipt-close-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(155, 89, 182, 0.4);
    }

    .stars-history-list {
      max-height: 60vh;
      overflow-y: auto;
      margin-bottom: 15px;
    }
    
    .stars-history-item {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all var(--anim-medium) ease;
      cursor: pointer;
      opacity: 0;
      animation: itemFadeIn 0.3s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.1s);
    }
    
    @keyframes itemFadeIn {
      100% { opacity: 1; }
    }
    
    .stars-history-item:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
    }
    
    .stars-history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .stars-history-date {
      font-size: 14px;
      font-weight: 600;
      color: #f39c12;
    }
    
    .stars-history-amount {
      font-size: 16px;
      font-weight: 700;
      color: #f39c12;
    }
    
    .stars-history-details {
      font-size: 12px;
      opacity: 0.9;
      color: #ccc;
    }
    
    .stars-history-expired {
      font-size: 11px;
      color: #e74c3c;
      margin-top: 5px;
      font-style: italic;
    }

    .glass-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      border-bottom: 1px solid var(--glass-border);
      background: var(--glass-bg-light);
      backdrop-filter: blur(10px);
    }
    
    .glass-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary);
    }
    
    .glass-close {
      border: none;
      background: var(--glass-bg);
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      cursor: pointer;
      color: var(--text-light);
      opacity: 0.7;
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border-light);
      transition: all var(--anim-medium) ease;
    }
    
    .glass-close:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }
    
    .glass-close:hover:not(:disabled) {
      opacity: 1;
      background: var(--glass-bg-light);
    }
    
    .glass-body {
      padding: 20px;
      max-height: calc(80vh - 80px);
      overflow-y: auto;
    }

    body.light-theme .glass-content {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(25px) saturate(200%);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.6),
        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
    }
    
    body.pink-theme .glass-content {
      background: rgba(74, 30, 53, 0.85);
      backdrop-filter: blur(25px) saturate(200%);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    body.light-theme .glass-header {
      background: rgba(255, 255, 255, 0.5);
      border-bottom: 1px solid rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(15px);
    }

    body.pink-theme .glass-header {
      background: rgba(109, 44, 80, 0.5);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    body.light-theme .glass-close {
      background: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: var(--text-dark);
    }

    body.pink-theme .glass-close {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: var(--text-light);
    }

    .settings-group {
      margin-bottom: 15px;
      opacity: 0;
      animation: settingFadeIn 0.3s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.1s + 0.3s);
    }
    
    @keyframes settingFadeIn {
      100% { opacity: 1; }
    }
    
    .settings-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text-light);
      opacity: 0.9;
    }
    
    .settings-select {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid var(--glass-border);
      background: var(--glass-bg);
      backdrop-filter: blur(10px);
      color: var(--text-light);
      font-size: 14px;
      transition: all var(--anim-medium) ease;
    }
    
    .settings-select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(0, 114, 65, 0.1);
      transform: translateY(-1px);
    }
    
    .daily-reward-banner {
      display: flex;
      align-items: center;
      background: var(--glass-bg);
      backdrop-filter: blur(15px);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 20px;
      border: 1px solid var(--glass-border);
      cursor: pointer;
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .daily-reward-banner:active {
      transform: scale(0.98);
    }
    
    .daily-reward-icon { 
      font-size: 20px; 
      width: 44px; 
      height: 44px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      border-radius: 12px; 
      background: rgba(52, 152, 219, 0.1);
      color: var(--secondary);
      margin-right: 14px;
      flex-shrink: 0;
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border-light);
    }
    
    .daily-reward-content {
      flex: 1;
    }
    
    .daily-reward-title { 
      font-weight: 600; 
      font-size: 15px; 
      margin-bottom: 4px; 
      color: var(--text-light);
    }
    
    .daily-reward-desc { 
      font-size: 12px; 
      opacity: 0.8; 
      color: var(--text-light);
    }
    
    .daily-reward-timer {
      font-size: 11px;
      margin-top: 4px;
      color: var(--secondary);
      font-weight: 600;
    }
    
    .more-grid { 
      display: grid; 
      grid-template-columns: repeat(2, 1fr); 
      gap: 12px; 
      margin-bottom: 20px; 
    }
    
    .more-item { 
      background: var(--glass-bg);
      backdrop-filter: blur(15px);
      border-radius: 14px; 
      padding: 16px 12px; 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      text-align: center; 
      cursor: pointer; 
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1); 
      border: 1px solid var(--glass-border);
      aspect-ratio: 1 / 1;
      justify-content: center;
      opacity: 0;
      animation: itemFadeIn 0.3s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.1s + 0.3s);
    }
    
    .more-item:hover:not(.disabled) {
      transform: translateY(-2px);
      box-shadow: var(--hover-shadow);
    }
    
    .more-item.disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }
    
    .more-item:active:not(.disabled) {
      transform: scale(0.96);
    }
    
    .more-icon { 
      font-size: 18px; 
      margin-bottom: 8px; 
      width: 44px; 
      height: 44px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      border-radius: 12px; 
      background: var(--glass-bg-light);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border-light);
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .more-item.disabled .more-icon {
      background: rgba(149, 165, 166, 0.2);
      border-color: rgba(149, 165, 166, 0.3);
    }
    
    .star-icon { 
      width: 44px; 
      height: 44px; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      border-radius: 12px; 
      background: rgba(149, 165, 166, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border-light);
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1);
      padding: 8px;
      margin-bottom: 8px;
    }
    
    .star-icon svg {
      width: 100%;
      height: 100%;
      fill: var(--disabled);
    }
    
    .more-item.disabled .star-icon {
      background: rgba(149, 165, 166, 0.2);
      border-color: rgba(149, 165, 166, 0.3);
    }
    
    .more-title { 
      font-weight: 600; 
      font-size: 13px; 
      margin-bottom: 4px; 
      color: var(--text-light);
    }
    
    .more-desc { 
      font-size: 11px; 
      opacity: 0.8; 
      color: var(--text-light);
    }
    
    .promo-code-item .more-icon { 
      color: var(--accent); 
      background: rgba(155, 89, 182, 0.1); 
    }
    
    .stats-item .more-icon { 
      color: var(--primary); 
      background: rgba(0, 114, 65, 0.1); 
    }
    
    .reset-item .more-icon { 
      color: var(--danger); 
      background: rgba(231, 76, 60, 0.1); 
    }
    
    .stars-item { 
      opacity: 1;
      cursor: pointer;
    }
    
    .stars-item.disabled {
      opacity: 1;
      cursor: pointer;
    }
    
    .stars-item .star-icon svg {
      fill: #f39c12;
    }
    
    .stars-item.disabled .star-icon svg {
      fill: #f39c12;
    }
    
    .stars-item .more-title,
    .stars-item .more-desc {
      color: var(--text-light);
    }

    .btn {
      width: 100%; 
      padding: 14px; 
      border-radius: 14px; 
      border: none; 
      font-size: 15px; 
      font-weight: 600; 
      cursor: pointer; 
      transition: all var(--anim-medium) cubic-bezier(0.4, 0, 0.2, 1); 
      margin-bottom: 12px; 
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    
    .btn:active:not(:disabled) {
      transform: scale(0.98);
    }
    
    .btn-primary {
      background: var(--secondary); 
      color: white; 
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
    }
    
    .btn-primary:disabled {
      background: #95a5a6;
      color: #bdc3c7;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .btn-accent {
      background: var(--accent); 
      color: white; 
      box-shadow: 0 4px 15px rgba(155, 89, 182, 0.3);
    }
    
    .btn-danger {
      background: var(--danger);
      color: white;
      box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
    }
    
    .btn-danger:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
    }
    
    .reward-timer {
      font-size: 13px;
      margin-top: 12px;
      color: var(--secondary);
      font-weight: 600;
      text-align: center;
      padding: 8px;
      background: rgba(52, 152, 219, 0.1);
      border-radius: 10px;
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border-light);
    }

    .stats-section {
      margin-bottom: 0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 15px;
    }
    
    .stat-card {
      background: var(--glass-bg);
      backdrop-filter: blur(15px);
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      border: 1px solid var(--glass-border);
      transition: all var(--anim-medium) ease;
      opacity: 0;
      animation: cardFadeIn 0.3s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.1s);
    }
    
    @keyframes cardFadeIn {
      100% { opacity: 1; }
    }
    
    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--hover-shadow);
    }
    
    .stat-value {
      font-size: 18px;
      font-weight: 700;
      margin: 5px 0;
      color: var(--primary);
    }
    
    .stat-label {
      font-size: 11px;
      opacity: 0.8;
      color: var(--text-light);
    }

    .stats-chart {
      height: 120px;
      background: var(--glass-bg);
      backdrop-filter: blur(15px);
      border-radius: 12px;
      margin-bottom: 15px;
      padding: 12px 8px 5px 8px;
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 4px;
      border: 1px solid var(--glass-border);
      opacity: 0;
      animation: chartFadeIn 0.5s ease-out 0.2s forwards;
    }
    
    @keyframes chartFadeIn {
      100% { opacity: 1; }
    }
    
    .chart-bar-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
      height: 100%;
      opacity: 0;
      animation: barFadeIn 0.5s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.1s + 0.4s);
    }
    
    @keyframes barFadeIn {
      100% { opacity: 1; }
    }
    
    .chart-bar {
      width: 100%;
      background: linear-gradient(to top, var(--primary), var(--primary-dark));
      border-radius: 4px 4px 0 0;
      transition: height 0.5s ease;
      min-height: 2px;
    }
    
    .chart-label {
      font-size: 9px;
      margin-top: 4px;
      opacity: 0.7;
      text-align: center;
      color: var(--text-light);
    }
    
    .toast { 
      position: fixed; 
      bottom: 90px; 
      left: 50%; 
      transform: translateX(-50%); 
      background: var(--glass-bg);
      backdrop-filter: blur(20px) saturate(180%);
      color: var(--text-light); 
      padding: 12px 20px; 
      border-radius: 10px; 
      z-index: 1000; 
      opacity: 0; 
      transition: opacity var(--anim-medium) ease; 
      max-width: 85%;
      text-align: center;
      font-weight: 600;
      font-size: 14px;
      border: 1px solid var(--glass-border);
      box-shadow: var(--card-shadow);
    }
    
    .toast.show { 
      opacity: 1; 
      animation: toastSlide 0.3s ease;
    }
    
    @keyframes toastSlide {
      0% { transform: translateX(-50%) translateY(20px); opacity: 0; }
      100% { transform: translateX(-50%) translateY(0); opacity: 1; }
    }

    body.light-theme .click-count {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
      color: var(--text-dark);
    }

    body.pink-theme .click-count {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
      color: var(--text-light);
    }

    body.light-theme .bottom-nav {
      background: rgba(255, 255, 255, 0.7);
      border-top: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }

    body.pink-theme .bottom-nav {
      background: rgba(255, 255, 255, 0.1);
      border-top: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .nav-icon {
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    body.pink-theme .nav-icon {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .nav-item.disabled .nav-icon {
      background: rgba(149, 165, 166, 0.2);
      border-color: rgba(149, 165, 166, 0.3);
    }

    body.light-theme .more-item {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.3);
      box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    body.pink-theme .more-item {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .more-item.disabled {
      background: rgba(149, 165, 166, 0.2);
      border-color: rgba(149, 165, 166, 0.3);
    }

    body.light-theme .more-icon {
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    body.pink-theme .more-icon {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    body.light-theme .more-item.disabled .more-icon {
      background: rgba(149, 165, 166, 0.2);
      border-color: rgba(149, 165, 166, 0.3);
    }
    
    body.light-theme .star-icon {
      background: rgba(149, 165, 166, 0.2);
      border: 1px solid rgba(149, 165, 166, 0.3);
    }

    body.pink-theme .star-icon {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .more-item.disabled .star-icon {
      background: rgba(149, 165, 166, 0.2);
      border-color: rgba(149, 165, 166, 0.3);
    }

    body.light-theme .stat-card {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    body.pink-theme .stat-card {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .stats-chart {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    body.pink-theme .stats-chart {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .daily-reward-banner {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    body.pink-theme .daily-reward-banner {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .daily-reward-icon {
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    body.pink-theme .daily-reward-icon {
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    body.light-theme .settings-select {
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: var(--text-dark);
    }

    body.pink-theme .settings-select {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
      color: var(--text-light);
    }

    body.light-theme .reward-timer {
      background: rgba(52, 152, 219, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    body.pink-theme .reward-timer {
      background: rgba(52, 152, 219, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    #stars-modal,
    #stars-history-modal {
      padding: 0 !important;
    }
    
    #stars-modal .glass-content,
    #stars-history-modal .glass-content {
      width: 100%;
      height: 100%;
      max-width: none;
      max-height: none;
      border-radius: 0;
      background: #000;
      backdrop-filter: none;
      display: flex;
      flex-direction: column;
      box-shadow: none;
      transform: none !important;
      overflow: hidden;
    }
    
    #stars-modal .glass-header,
    #stars-history-modal .glass-header {
      background: rgba(0, 0, 0, 0.95);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      padding: 20px;
      flex-shrink: 0;
      position: relative;
      z-index: 10;
    }
    
    #stars-modal .glass-body,
    #stars-history-modal .glass-body {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      background: #000;
      display: flex;
      flex-direction: column;
      position: relative;
      padding-bottom: 80px;
    }
    
    #stars-modal .glass-title,
    #stars-history-modal .glass-title {
      color: #f39c12;
      font-size: 20px;
    }
    
    #stars-modal .glass-close,
    #stars-history-modal .glass-close {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: #fff;
    }
    
    #stars-modal .stars-card {
      margin-bottom: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      z-index: 2;
    }
    
    #stars-modal .stars-reward-title {
      font-size: 19px;
      color: #fff;
    }
    
    #stars-modal .stars-reward-desc {
      color: #ddd;
      font-size: 15px;
    }
    
    #stars-modal .stars-reward-amount {
      font-size: 22px;
      background: rgba(243, 156, 18, 0.2);
      border: 1px solid rgba(243, 156, 18, 0.4);
    }
    
    #stars-modal .stars-progress {
      background: rgba(255, 255, 255, 0.2);
    }
    
    #stars-modal .stars-progress-text {
      font-size: 13px;
      color: #ddd;
    }
    
    .stars-history-bottom-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.15);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
      height: 70px;
      min-height: 70px;
      padding: 0;
    }
    
    .stars-history-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: none;
      color: #fff;
      cursor: pointer;
      transition: all var(--anim-medium) ease;
      padding: 10px 20px;
      width: 100%;
      height: 100%;
      max-width: 150px;
    }
    
    .stars-history-btn:hover {
      opacity: 0.8;
    }
    
    .stars-history-btn:active {
      transform: scale(0.95);
    }
    
    .stars-history-icon {
      font-size: 22px;
      margin-bottom: 4px;
      color: #fff;
    }
    
    .stars-history-label {
      font-size: 12px;
      color: #aaa;
      text-align: center;
      line-height: 1.2;
    }
    
    #stars-warning-modal,
    #stars-receipt-modal {
      padding: 0 !important;
    }
    
    #stars-warning-modal .glass-content,
    #stars-receipt-modal .glass-content {
      width: 100%;
      height: 100%;
      max-width: none;
      max-height: none;
      border-radius: 0;
      background: #000 !important;
      backdrop-filter: none;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      box-shadow: none;
      transform: none !important;
      overflow: hidden;
      padding: 20px;
    }
    
    #stars-warning-modal .glass-body,
    #stars-receipt-modal .glass-body {
      flex: 1;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      overflow-y: auto;
    }
    
    #stars-warning-modal .warning-content,
    #stars-receipt-modal .receipt-container {
      max-width: 500px;
      width: 100%;
    }
    
    #stars-receipt-modal .glass-header {
      display: none !important;
    }
    
    #stars-receipt-modal .glass-body {
      padding: 20px;
      justify-content: flex-start;
    }

    /* Settings toggle styles */
    .setting-toggle {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid var(--glass-border-light);
      margin-bottom: 15px;
    }
    
    .setting-toggle:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    
    .toggle-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-light);
      opacity: 0.9;
    }
    
    .toggle-switch {
      position: relative;
      width: 50px;
      height: 26px;
      background: var(--glass-bg);
      border-radius: 13px;
      border: 1px solid var(--glass-border);
      cursor: pointer;
      transition: all var(--anim-medium) ease;
      backdrop-filter: blur(10px);
    }
    
    .toggle-switch.active {
      background: var(--primary);
      border-color: var(--primary);
    }
    
    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      transition: all var(--anim-medium) ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .toggle-switch.active::after {
      transform: translateX(24px);
    }

    /* Ночной режим - ограничение кликов */
    .night-time-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      text-align: center;
      padding: 20px;
      z-index: 5;
      width: 80%;
      max-width: 280px;
      border: 2px solid #f39c12;
      box-shadow: 0 0 30px rgba(243, 156, 18, 0.3);
    }

    .night-time-icon {
      font-size: 40px;
      margin-bottom: 15px;
      animation: moonGlow 3s infinite alternate;
    }

    @keyframes moonGlow {
      0% { transform: scale(1); opacity: 0.7; text-shadow: 0 0 10px rgba(243, 156, 18, 0.5); }
      100% { transform: scale(1.1); opacity: 1; text-shadow: 0 0 20px rgba(243, 156, 18, 0.8); }
    }

    .night-time-text {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 8px;
      color: #f39c12;
    }

    .night-time-subtext {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 5px;
      line-height: 1.4;
    }

    .night-time-current {
      font-size: 12px;
      opacity: 0.7;
      margin-top: 10px;
      padding: 5px 10px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    /* Night mode for banners and buttons */
    .night-mode-disabled {
      opacity: 0.5 !important;
      cursor: not-allowed !important;
      pointer-events: none !important;
      filter: grayscale(0.5) !important;
    }

    /* Клик-сессии */
    .click-sessions-section {
      margin-top: 25px;
      padding-top: 25px;
      border-top: 1px solid var(--glass-border);
    }
    
    .click-sessions-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      color: var(--primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .view-all-btn {
      font-size: 12px;
      color: var(--secondary);
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 6px;
      transition: all var(--anim-fast) ease;
    }
    
    .view-all-btn:hover {
      background: rgba(52, 152, 219, 0.1);
    }
    
    .click-sessions-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .click-session-item {
      background: var(--glass-bg);
      backdrop-filter: blur(15px);
      border-radius: 12px;
      padding: 15px;
      border: 1px solid var(--glass-border);
      transition: all var(--anim-medium) ease;
      opacity: 0;
      animation: sessionFadeIn 0.3s ease-out forwards;
      animation-delay: calc(var(--i, 0) * 0.1s);
      margin-bottom: 8px;
    }
    
    .click-session-item:last-child {
      margin-bottom: 0;
    }
    
    @keyframes sessionFadeIn {
      100% { opacity: 1; }
    }
    
    .click-session-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--hover-shadow);
    }
    
    .click-session-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .click-session-date {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-light);
    }
    
    .click-session-count {
      font-size: 16px;
      font-weight: 700;
      color: var(--primary);
    }
    
    .click-session-details {
      font-size: 12px;
      opacity: 0.9;
      color: var(--text-light);
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    
    .click-session-duration {
      font-size: 11px;
      color: var(--accent);
      font-weight: 500;
    }
    
    .click-session-cps {
      font-size: 11px;
      color: var(--warning);
      font-weight: 500;
    }
    
    .click-session-progress {
      height: 4px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 2px;
      overflow: hidden;
      margin-top: 8px;
    }
    
    .click-session-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
      border-radius: 2px;
      transition: width 0.5s ease;
    }
    
    .full-history-modal .glass-content {
      width: min(420px, 94vw);
      max-height: 85vh;
    }
    
    .full-history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .full-history-list {
      max-height: 60vh;
      overflow-y: auto;
      margin-bottom: 20px;
    }
    
    .history-empty {
      text-align: center;
      padding: 40px 20px;
      opacity: 0.7;
    }
    
    .history-empty-icon {
      font-size: 40px;
      margin-bottom: 15px;
      opacity: 0.5;
      color: var(--text-light);
    }
    
    .history-empty-text h3 {
      margin-bottom: 10px;
      font-size: 16px;
      color: var(--text-light);
    }
    
    .history-empty-text p {
      font-size: 13px;
      opacity: 0.8;
      color: var(--text-light);
    }

    /* Стили для светлой темы */
    body.light-theme .click-session-date,
    body.light-theme .click-session-details,
    body.light-theme .history-empty-text h3,
    body.light-theme .history-empty-text p,
    body.light-theme .history-empty-icon {
      color: var(--text-dark);
    }
    
    body.light-theme .click-session-item {
      color: var(--text-dark);
    }
    
    body.light-theme .click-session-progress {
      background: rgba(0, 0, 0, 0.1);
    }

    /* Стили для розовой темы */
    body.pink-theme .click-session-date,
    body.pink-theme .click-session-details,
    body.pink-theme .history-empty-text h3,
    body.pink-theme .history-empty-text p,
    body.pink-theme .history-empty-icon {
      color: var(--text-light);
    }

    @media (max-width: 480px) {
      .frog { 
        width: min(240px, 60vw); 
        height: min(240px, 60vw); 
        font-size: min(140px, 35vw); 
      }
      
      .click-count {
        font-size: clamp(28px, 8vw, 40px);
        padding: 14px 24px;
        margin-bottom: 12px;
      }
      
      .more-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }
      
      .more-item {
        aspect-ratio: 1 / 1;
        padding: 12px 8px;
        justify-content: center;
      }
      
      .more-icon {
        width: 40px;
        height: 40px;
        font-size: 16px;
        margin-bottom: 6px;
      }
      
      .star-icon {
        width: 40px;
        height: 40px;
        padding: 6px;
        margin-bottom: 6px;
      }
      
      .more-title {
        font-size: 12px;
        margin-bottom: 3px;
      }
      
      .more-desc {
        font-size: 10px;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }
      
      .stats-chart {
        height: 100px;
        padding: 10px 6px 3px 6px;
      }
      
      .receipt-container {
        padding: 20px 15px;
        max-height: 90vh;
      }
      
      .receipt-row {
        font-size: 13px;
        padding: 6px 0;
      }
      
      .receipt-close-btn {
        padding: 12px 30px;
        min-width: 180px;
        font-size: 15px;
      }
      
      .stars-notification {
        width: 90%;
        max-width: 300px;
        padding: 14px 18px;
      }
      
      .stars-notification-icon {
        font-size: 28px;
      }
      
      .stars-notification-text {
        font-size: 14px;
      }
      
      .stars-notification-stars {
        font-size: 22px;
      }
      
      .stars-notification-btn {
        padding: 8px 20px;
        font-size: 13px;
      }
      
      .warning-content {
        padding: 25px 20px;
        margin: 10px;
      }
      
      .warning-buttons {
        flex-direction: column;
        gap: 10px;
      }
      
      .warning-btn {
        padding: 14px 20px;
        font-size: 16px;
      }
      
      #stars-modal .glass-body,
      #stars-history-modal .glass-body {
        padding: 15px;
        padding-bottom: 70px;
      }
      
      #stars-modal .glass-header,
      #stars-history-modal .glass-header {
        padding: 15px;
      }
      
      #stars-modal .stars-card {
        padding: 15px;
        margin-bottom: 15px;
      }
      
      #stars-modal .stars-reward-title {
        font-size: 17px;
      }
      
      #stars-modal .stars-reward-amount {
        font-size: 18px;
        padding: 6px 12px;
      }
      
      .stars-history-bottom-panel {
        height: 65px;
        min-height: 65px;
      }
      
      .stars-history-btn {
        max-width: 130px;
      }
      
      .stars-history-icon {
        font-size: 20px;
      }
      
      .stars-history-label {
        font-size: 11px;
      }
      
      .stars-history-list {
        max-height: 55vh;
      }
      
      .stars-history-item {
        padding: 12px;
        margin-bottom: 8px;
      }
      
      #stars-warning-modal .warning-content,
      #stars-receipt-modal .receipt-container {
        padding: 20px;
        margin: 10px;
      }
      
      #stars-receipt-modal .glass-body {
        padding: 15px;
      }
      
      .toggle-switch {
        width: 44px;
        height: 24px;
      }
      
      .toggle-switch.active::after {
        transform: translateX(20px);
      }
      
      /* Клик-сессии адаптив */
      .click-session-item {
        padding: 12px;
      }
      
      .click-session-count {
        font-size: 14px;
      }
      
      .click-session-date {
        font-size: 12px;
      }
      
      .click-session-details {
        font-size: 11px;
      }
      
      /* Ночной режим адаптив */
      .night-time-overlay {
        max-width: 250px;
        padding: 15px;
      }
      
      .night-time-icon {
        font-size: 32px;
        margin-bottom: 10px;
      }
      
      .night-time-text {
        font-size: 14px;
      }
      
      .night-time-subtext {
        font-size: 12px;
      }
    }
    
    @media (max-width: 380px) {
      .frog { 
        width: min(200px, 50vw); 
        height: min(200px, 50vw); 
        font-size: min(120px, 30vw); 
      }
      
      .click-count {
        font-size: clamp(24px, 7vw, 36px);
        padding: 12px 20px;
      }
      
      .glass-body {
        padding: 16px;
      }
      
      .more-item {
        padding: 10px 6px;
      }
      
      .more-icon {
        width: 36px;
        height: 36px;
        font-size: 15px;
        margin-bottom: 5px;
      }
      
      .star-icon {
        width: 36px;
        height: 36px;
        padding: 5px;
        margin-bottom: 5px;
      }
      
      .more-title {
        font-size: 11px;
      }
      
      .more-desc {
        font-size: 9px;
      }
      
      .receipt-container {
        padding: 15px 12px;
      }
      
      .receipt-title {
        font-size: 18px;
      }
      
      .receipt-row {
        font-size: 12px;
      }
      
      .receipt-close-btn {
        padding: 10px 25px;
        min-width: 160px;
        font-size: 14px;
      }
      
      .stars-notification {
        width: 95%;
        padding: 12px 15px;
      }
      
      .stars-notification-text {
        font-size: 13px;
      }
      
      .stars-notification-stars {
        font-size: 20px;
      }
      
      #stars-modal .stars-card {
        padding: 12px;
        margin-bottom: 12px;
      }
      
      #stars-modal .glass-body {
        padding: 12px;
        padding-bottom: 65px;
      }
      
      .stars-history-bottom-panel {
        height: 60px;
        min-height: 60px;
      }
      
      .stars-history-btn {
        max-width: 120px;
      }
      
      .stars-history-icon {
        font-size: 18px;
      }
      
      .stars-history-label {
        font-size: 10px;
        line-height: 1.1;
      }
      
      .stars-history-list {
        max-height: 50vh;
      }
      
      .toggle-switch {
        width: 40px;
        height: 22px;
      }
      
      .toggle-switch::after {
        width: 18px;
        height: 18px;
      }
      
      .toggle-switch.active::after {
        transform: translateX(18px);
      }
      
      /* Клик-сессии адаптив */
      .click-session-item {
        padding: 10px;
      }
      
      .click-session-count {
        font-size: 13px;
      }
      
      .click-session-date {
        font-size: 11px;
      }
      
      /* Ночной режим адаптив */
      .night-time-overlay {
        max-width: 220px;
        padding: 12px;
      }
      
      .night-time-icon {
        font-size: 28px;
      }
      
      .night-time-text {
        font-size: 13px;
      }
      
      .night-time-subtext {
        font-size: 11px;
      }
    }
    
    @media (max-height: 700px) {
      .frog { 
        width: min(180px, 45vw); 
        height: min(180px, 45vw); 
        font-size: min(100px, 25vw); 
      }
      
      .click-count {
        margin-bottom: 8px;
      }
      
      .stars-notification {
        top: 10px;
        max-width: 95%;
      }
      
      .receipt-container {
        max-height: 80vh;
        padding: 15px;
      }
      
      .stars-history-list {
        max-height: 45vh;
      }
      
      #stars-modal .stars-card {
        padding: 12px;
        margin-bottom: 10px;
      }
      
      #stars-modal .stars-reward {
        margin-bottom: 10px;
      }
      
      #stars-modal .glass-body {
        padding: 12px;
        padding-bottom: 65px;
      }
      
      .stars-history-bottom-panel {
        height: 60px;
        min-height: 60px;
      }
      
      .stars-history-btn {
        max-width: 120px;
      }
      
      .stars-history-icon {
        font-size: 18px;
        margin-bottom: 2px;
      }
      
      .stars-history-label {
        font-size: 10px;
      }
      
      .night-time-overlay {
        padding: 15px;
      }
      
      .night-time-icon {
        font-size: 32px;
        margin-bottom: 10px;
      }
    }
  </style>
</head>
<body class="dark-theme">
  <div class="anti-cheat-overlay" id="anti-cheat-overlay">
    <div class="anti-cheat-message" id="anti-cheat-message">
      АНТИ-ЧИТ АКТИВИРОВАН!<br>Не нажимайте нигде!
    </div>
    <div class="cheater-detected" id="cheater-detected" style="display: none;">
      ЧИТЕР ОБНАРУЖЕН!
    </div>
    <div class="ban-timer" id="ban-timer" style="display: none;">
      Осталось времени бана: <span id="ban-time">30:00</span>
    </div>
  </div>

  <div class="stars-notification" id="stars-notification">
    <button class="stars-notification-close" id="stars-notification-close">×</button>
    <div class="stars-notification-content">
      <div class="stars-notification-icon">
        <i class="fas fa-star"></i>
      </div>
      <div class="stars-notification-text">
        🎉 Поздравляем! Вы набрали достаточно кликов для вывода звёзд!
      </div>
      <div class="stars-notification-stars" id="stars-notification-amount">0 ⭐</div>
      <button class="stars-notification-btn" id="stars-notification-btn">
        ПЕРЕЙТИ К ЗВЁЗДАМ
      </button>
    </div>
  </div>

  <div class="main-content">
    <div class="click-count" id="click-count">0</div>
    
    <div class="frog-container">
      <div class="frog" id="frog">🐸</div>
    </div>
  </div>

  <div class="bottom-nav">
    <div class="nav-item" id="more-btn">
      <div class="nav-icon"><i class="fas fa-ellipsis-h"></i></div>
      <div>Ещё</div>
    </div>
    <div class="nav-item" id="settings-btn">
      <div class="nav-icon"><i class="fas fa-cog"></i></div>
      <div>Настройки</div>
    </div>
  </div>

  <div class="glass-modal" id="settings-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Настройки</h2>
        <button class="glass-close" id="close-settings">×</button>
      </div>
      <div class="glass-body">
        <div class="settings-group" style="--i: 0">
          <label class="settings-label">Тема</label>
          <select class="settings-select" id="theme-select">
            <option value="dark">Тёмная тема</option>
            <option value="light">Светлая тема</option>
            <option value="pink">Розовая тема</option>
          </select>
        </div>
        
        <div class="setting-toggle" style="--i: 1">
          <div class="toggle-label">
            <span>Улучшение анимаций</span>
          </div>
          <div class="toggle-switch active" id="animations-toggle"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="glass-modal" id="more-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Ещё</h2>
        <button class="glass-close" id="close-more">×</button>
      </div>
      
      <div class="glass-body">
        <div class="daily-reward-banner" id="daily-reward-banner">
          <div class="daily-reward-icon"><i class="fas fa-gift"></i></div>
          <div class="daily-reward-content">
            <div class="daily-reward-title">Ежедневная награда</div>
            <div class="daily-reward-desc">Получите 1000 кликов!</div>
            <div class="daily-reward-timer" id="daily-reward-timer"></div>
          </div>
        </div>
        
        <div class="more-grid">
          <div class="more-item promo-code-item" id="promo-code-item" style="--i: 0">
            <div class="more-icon"><i class="fas fa-tag"></i></div>
            <div class="more-title">Промо-коды</div>
            <div class="more-desc">Активируйте бонусы</div>
          </div>
          
          <div class="more-item stats-item" id="stats-item" style="--i: 1">
            <div class="more-icon"><i class="fas fa-chart-bar"></i></div>
            <div class="more-title">Статистика</div>
            <div class="more-desc">Просмотр прогресса</div>
          </div>
          
          <div class="more-item reset-item" id="reset-item" style="--i: 2">
            <div class="more-icon"><i class="fas fa-undo"></i></div>
            <div class="more-title">Сбросить прогресс</div>
            <div class="more-desc">Начать заново</div>
          </div>
          
          <div class="more-item stars-item" id="stars-item" style="--i: 3">
            <div class="star-icon">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z" />
              </svg>
            </div>
            <div class="more-title">Звёзды</div>
            <div class="more-desc">Получить награды</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="glass-modal" id="daily-reward-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Ежедневная награда</h2>
        <button class="glass-close" id="close-daily">×</button>
      </div>
      <div class="glass-body">
        <p style="margin-bottom: 20px; text-align: center; opacity: 0.9; color: var(--text-light);">Получите ежедневную награду в 1000 кликов!</p>
        <button class="btn btn-primary" id="daily-reward-btn">Получить 1000 кликов</button>
        <div class="reward-timer" id="reward-timer"></div>
      </div>
    </div>
  </div>

  <div class="glass-modal" id="promo-code-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Промо-коды</h2>
        <button class="glass-close" id="close-promo">×</button>
      </div>
      <div class="glass-body">
        <p style="margin-bottom: 15px; text-align: center; opacity: 0.9; color: var(--text-light);">Введите промо-код для получения бонусных кликов!</p>
        
        <input type="text" class="settings-select" id="promo-input" placeholder="Введите промо-код" style="margin-bottom: 15px;">
        <button class="btn btn-accent" id="promo-btn">Активировать</button>
      </div>
    </div>
  </div>

  <div class="glass-modal" id="stats-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Статистика</h2>
        <button class="glass-close" id="close-stats">×</button>
      </div>
      <div class="glass-body">
        <div class="stats-section">
          <div class="stats-chart" id="stats-chart"></div>
          <div class="stats-grid">
            <div class="stat-card" style="--i: 0">
              <div class="stat-value" id="stat-today">0</div>
              <div class="stat-label">Сегодня</div>
            </div>
            <div class="stat-card" style="--i: 1">
              <div class="stat-value" id="stat-week">0</div>
              <div class="stat-label">Эта неделя</div>
            </div>
            <div class="stat-card" style="--i: 2">
              <div class="stat-value" id="stat-month">0</div>
              <div class="stat-label">Этот месяц</div>
            </div>
            <div class="stat-card" style="--i: 3">
              <div class="stat-value" id="stat-avg-cps">0.0</div>
              <div class="stat-label">Средний CPS</div>
            </div>
          </div>
        </div>
        
        <!-- Клик-сессии -->
        <div class="click-sessions-section">
          <div class="click-sessions-title">
            <span>История клик-сессий</span>
            <button class="view-all-btn" id="view-all-sessions">Все</button>
          </div>
          <div class="click-sessions-list" id="click-sessions-list">
            <!-- Здесь будут отображаться последние 3 сессии -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="glass-modal" id="reset-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Сброс прогресса</h2>
        <button class="glass-close" id="close-reset">×</button>
      </div>
      <div class="glass-body">
        <p style="margin-bottom: 20px; text-align: center; color: var(--danger); opacity: 0.9;">Это навсегда удалит весь ваш прогресс. Это действие нельзя отменить!</p>
        <button class="btn btn-danger" id="reset-btn">Сбросить прогресс</button>
      </div>
    </div>
  </div>

  <div class="glass-modal" id="stars-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Награды за звёзды</h2>
        <button class="glass-close" id="close-stars">×</button>
      </div>
      <div class="glass-body">
        <div class="stars-card" id="stars-card-1" data-reward="1" data-clicks="60000" data-stars="50" style="--i: 0">
          <div class="stars-reward">
            <div class="stars-reward-info">
              <div class="stars-reward-title">🐸 60,000 кликов</div>
              <div class="stars-reward-desc">Достигните 60к кликов</div>
            </div>
            <div class="stars-reward-amount">50 ⭐</div>
          </div>
          <div class="stars-progress">
            <div class="stars-progress-bar" id="stars-progress-1"></div>
          </div>
          <div class="stars-progress-text">
            <span id="stars-current-1">0</span>
            <span>60,000</span>
          </div>
        </div>
        
        <div class="stars-card" id="stars-card-2" data-reward="2" data-clicks="110000" data-stars="100" style="--i: 1">
          <div class="stars-reward">
            <div class="stars-reward-info">
              <div class="stars-reward-title">🐸 110,000 кликов</div>
              <div class="stars-reward-desc">Достигните 110к кликов</div>
            </div>
            <div class="stars-reward-amount">100 ⭐</div>
          </div>
          <div class="stars-progress">
            <div class="stars-progress-bar" id="stars-progress-2"></div>
          </div>
          <div class="stars-progress-text">
            <span id="stars-current-2">0</span>
            <span>110,000</span>
          </div>
        </div>
        
        <div class="stars-card" id="stars-card-3" data-reward="3" data-clicks="160000" data-stars="150" style="--i: 2">
          <div class="stars-reward">
            <div class="stars-reward-info">
              <div class="stars-reward-title">🐸 160,000 кликов</div>
              <div class="stars-reward-desc">Достигните 160к кликов</div>
            </div>
            <div class="stars-reward-amount">150 ⭐</div>
          </div>
          <div class="stars-progress">
            <div class="stars-progress-bar" id="stars-progress-3"></div>
          </div>
          <div class="stars-progress-text">
            <span id="stars-current-3">0</span>
            <span>160,000</span>
          </div>
        </div>
        
        <div class="stars-card" id="stars-card-4" data-reward="4" data-clicks="210000" data-stars="200" style="--i: 3">
          <div class="stars-reward">
            <div class="stars-reward-info">
              <div class="stars-reward-title">🐸 210,000 кликов</div>
              <div class="stars-reward-desc">Достигните 210к кликов</div>
            </div>
            <div class="stars-reward-amount">200 ⭐</div>
          </div>
          <div class="stars-progress">
            <div class="stars-progress-bar" id="stars-progress-4"></div>
          </div>
          <div class="stars-progress-text">
            <span id="stars-current-4">0</span>
            <span>210,000</span>
          </div>
        </div>
      </div>
      
      <div class="stars-history-bottom-panel">
        <button class="stars-history-btn" id="stars-history-btn">
          <div class="stars-history-icon"><i class="fas fa-history"></i></div>
          <div class="stars-history-label">История выводов</div>
        </button>
      </div>
    </div>
  </div>

  <div class="glass-modal" id="stars-history-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">История выводов</h2>
        <button class="glass-close" id="close-stars-history">×</button>
      </div>
      <div class="glass-body">
        <div class="stars-history-list" id="stars-history-list"></div>
        <div id="stars-history-empty" style="text-align: center; padding: 40px 20px; opacity: 0.7;">
          <i class="fas fa-history" style="font-size: 40px; margin-bottom: 15px; opacity: 0.5;"></i>
          <h3 style="margin-bottom: 10px; color: var(--text-light);">Выводов ещё не было</h3>
          <p style="color: var(--text-light);">Ваша история выводов появится здесь</p>
        </div>
      </div>
    </div>
  </div>

  <div class="glass-modal warning-modal" id="stars-warning-modal">
    <div class="glass-content">
      <div class="glass-body">
        <div class="warning-content">
          <div class="warning-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h2 class="warning-title">⚠️ ВАЖНОЕ ПРЕДУПРЕЖДЕНИЕ</h2>
          <div class="warning-text">
            <p>Перед продолжением приготовьтесь сделать <strong>СКРИНШОТ</strong> чека!</p>
            <p>Вы ДОЛЖНЫ отправить этот скриншот боту <strong>@Cvapik_bot</strong> в Telegram для получения звёзд!</p>
            <p>Чек содержит всю необходимую информацию для верификации.</p>
            <p style="color: #f39c12; font-weight: bold; margin-top: 15px;">После получения награды ваши клики обнулятся!</p>
          </div>
          <div class="warning-buttons">
            <button class="warning-btn warning-btn-cancel" id="stars-warning-cancel">ОТМЕНА</button>
            <button class="warning-btn" id="stars-warning-confirm">ПРОДОЛЖИТЬ</button>
          </div>
          <div class="warning-timer" id="warning-timer">Пожалуйста, подождите 10 секунд...</div>
        </div>
      </div>
    </div>
  </div>

  <div class="glass-modal receipt-modal" id="stars-receipt-modal">
    <div class="glass-content">
      <div class="glass-body">
        <div class="receipt-container" id="stars-receipt">
          <div class="receipt-header">
            <div class="receipt-title">CVAPTA FROG</div>
            <div class="receipt-subtitle">ЧЕК ВЫВОДА ЗВЁЗД</div>
          </div>
          
          <div class="receipt-details">
            <div class="receipt-row" style="--i: 0">
              <span>ID чека:</span>
              <span id="receipt-id">#000001</span>
            </div>
            <div class="receipt-row" style="--i: 1">
              <span>Дата и время:</span>
              <span id="receipt-date">01/01/2024 12:00:00</span>
            </div>
            <div class="receipt-row" style="--i: 2">
              <span>Всего банов:</span>
              <span id="receipt-bans">0</span>
            </div>
            <div class="receipt-row" style="margin-top: 20px; --i: 3">
              <span>Кликов выведено:</span>
              <span id="receipt-clicks">0</span>
            </div>
            <div class="receipt-row" style="--i: 4">
              <span>Звёзд получено:</span>
              <span id="receipt-stars">0 ⭐</span>
            </div>
            <div class="receipt-row total">
              <span>ВСЕГО ЗВЁЗД:</span>
              <span id="receipt-total-stars">0 ⭐</span>
            </div>
            <div class="receipt-row warning">
              <span>ОТПРАВИТЬ:</span>
              <span>@Cvapik_bot</span>
            </div>
          </div>
          
          <div class="receipt-footer">
            <p>⚠️ СДЕЛАЙТЕ СКРИНШОТ и отправьте @Cvapik_bot!</p>
            <p>Этот чек действителен 3 дня</p>
            <p>Для вопросов обратитесь в поддержку с ID чека</p>
          </div>
          
          <div class="receipt-close-container">
            <button class="receipt-close-btn" id="receipt-close-btn">
              ЗАКРЫТЬ (Подождите 10 секунд...)
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Модальное окно для полной истории клик-сессий -->
  <div class="glass-modal full-history-modal" id="full-history-modal">
    <div class="glass-content">
      <div class="glass-header">
        <h2 class="glass-title">Полная история клик-сессий</h2>
        <button class="glass-close" id="close-full-history">×</button>
      </div>
      <div class="glass-body">
        <div class="full-history-header">
          <div style="color: var(--text-light);">Всего сессий: <span id="total-sessions-count">0</span></div>
        </div>
        <div class="full-history-list" id="full-history-list">
          <!-- Здесь будет полная история -->
        </div>
        <div id="full-history-empty" class="history-empty">
          <div class="history-empty-icon">
            <i class="fas fa-history"></i>
          </div>
          <div class="history-empty-text">
            <h3>История сессий пуста</h3>
            <p>Ваши клик-сессии появятся здесь</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // Game State
    let clicks = 0;
    let lastDailyReward = 0;
    let usedPromoCodes = [];
    let activeEffects = 0;
    const MAX_EFFECTS = 3;
    let sessionStartTime = Date.now();
    let totalSessionClicks = 0;
    let totalBans = 0;
    let clickHistory = {
      daily: {},
      weekly: {},
      monthly: {}
    };
    
    // Клик-сессии
    let clickSessions = [];
    let currentSession = null;
    let sessionTimeout = null;
    const SESSION_TIMEOUT = 1000; // 1 секунда паузы для завершения сессии
    
    // Stars System
    let starsRewards = [
      { clicks: 60000, stars: 50 },
      { clicks: 110000, stars: 100 },
      { clicks: 160000, stars: 150 },
      { clicks: 210000, stars: 200 }
    ];
    
    let withdrawalHistory = [];
    
    // Уведомления о доступных звёздах
    let availableStarsNotifications = [];
    let lastNotificationTime = 0;
    const NOTIFICATION_COOLDOWN = 30000;
    
    // Anti-Cheat System
    const MAX_CPS = 13;
    let clickTimestamps = [];
    let antiCheatActive = false;
    let cheatDetectionCount = 0;
    let isBanned = false;
    let banEndTime = 0;

    // Animation setting
    let animationsEnabled = true;

    // Night time restriction
    let isNightTime = false;
    let nightTimeCheckInterval = null;

    // DOM Elements
    const frogElement = document.getElementById('frog');
    const clickCountElement = document.getElementById('click-count');
    const bodyElement = document.body;
    const frogContainer = document.querySelector('.frog-container');
    
    // Glass Modals
    const settingsModal = document.getElementById('settings-modal');
    const moreModal = document.getElementById('more-modal');
    const dailyRewardModal = document.getElementById('daily-reward-modal');
    const promoCodeModal = document.getElementById('promo-code-modal');
    const statsModal = document.getElementById('stats-modal');
    const resetModal = document.getElementById('reset-modal');
    const starsModal = document.getElementById('stars-modal');
    const starsHistoryModal = document.getElementById('stars-history-modal');
    const starsWarningModal = document.getElementById('stars-warning-modal');
    const starsReceiptModal = document.getElementById('stars-receipt-modal');
    const fullHistoryModal = document.getElementById('full-history-modal');
    
    // Уведомление о звёздах
    const starsNotification = document.getElementById('stars-notification');
    const starsNotificationClose = document.getElementById('stars-notification-close');
    const starsNotificationBtn = document.getElementById('stars-notification-btn');
    const starsNotificationAmount = document.getElementById('stars-notification-amount');

    // Buttons
    const settingsBtn = document.getElementById('settings-btn');
    const moreBtn = document.getElementById('more-btn');
    const closeSettings = document.getElementById('close-settings');
    const closeMore = document.getElementById('close-more');
    const closeDaily = document.getElementById('close-daily');
    const closePromo = document.getElementById('close-promo');
    const closeStats = document.getElementById('close-stats');
    const closeReset = document.getElementById('close-reset');
    const closeStars = document.getElementById('close-stars');
    const closeStarsHistory = document.getElementById('close-stars-history');
    const closeFullHistory = document.getElementById('close-full-history');
    const dailyRewardBtn = document.getElementById('daily-reward-btn');
    const promoBtn = document.getElementById('promo-btn');
    const resetBtn = document.getElementById('reset-btn');
    const dailyRewardBanner = document.getElementById('daily-reward-banner');
    const promoCodeItem = document.getElementById('promo-code-item');
    const statsItem = document.getElementById('stats-item');
    const resetItem = document.getElementById('reset-item');
    const starsItem = document.getElementById('stars-item');
    const starsHistoryBtn = document.getElementById('stars-history-btn');
    const starsWarningConfirm = document.getElementById('stars-warning-confirm');
    const starsWarningCancel = document.getElementById('stars-warning-cancel');
    const receiptCloseBtn = document.getElementById('receipt-close-btn');
    const viewAllSessionsBtn = document.getElementById('view-all-sessions');
    
    // Settings toggle
    const animationsToggle = document.getElementById('animations-toggle');

    // Statistics Elements
    const statTodayElement = document.getElementById('stat-today');
    const statWeekElement = document.getElementById('stat-week');
    const statMonthElement = document.getElementById('stat-month');
    const statAvgCPSElement = document.getElementById('stat-avg-cps');
    const statsChartElement = document.getElementById('stats-chart');
    const clickSessionsList = document.getElementById('click-sessions-list');
    const fullHistoryList = document.getElementById('full-history-list');
    const fullHistoryEmpty = document.getElementById('full-history-empty');
    const totalSessionsCount = document.getElementById('total-sessions-count');

    // Timers
    const dailyRewardTimerElement = document.getElementById('daily-reward-timer');
    const rewardTimerElement = document.getElementById('reward-timer');

    // Settings
    const themeSelect = document.getElementById('theme-select');

    // Toast
    const toastElement = document.getElementById('toast');
    
    // Anti-Cheat Elements
    const antiCheatOverlay = document.getElementById('anti-cheat-overlay');
    const antiCheatMessage = document.getElementById('anti-cheat-message');
    const cheaterDetected = document.getElementById('cheater-detected');
    const banTimer = document.getElementById('ban-timer');
    const banTimeElement = document.getElementById('ban-time');

    // Stars Elements
    const starsHistoryList = document.getElementById('stars-history-list');
    const starsHistoryEmpty = document.getElementById('stars-history-empty');
    const warningTimer = document.getElementById('warning-timer');
    
    // Receipt Elements
    const receiptIdElement = document.getElementById('receipt-id');
    const receiptDateElement = document.getElementById('receipt-date');
    const receiptBansElement = document.getElementById('receipt-bans');
    const receiptClicksElement = document.getElementById('receipt-clicks');
    const receiptStarsElement = document.getElementById('receipt-stars');
    const receiptTotalStarsElement = document.getElementById('receipt-total-stars');

    // Variables for current withdrawal and receipt context
    let currentWithdrawal = null;
    let currentReceiptContext = null;
    let warningTimerInterval = null;
    let receiptTimerInterval = null;

    // Флаг для отслеживания ожидания перехода между модальными окнами
    let isModalTransitioning = false;

    // Функция для проверки текущего времени
    function checkTimeRestrictions() {
      const now = new Date();
      const currentHour = now.getHours();
      
      // Проверяем, находится ли текущее время в запрещенном интервале (22:00-07:00)
      const wasNightTime = isNightTime;
      isNightTime = (currentHour >= 22 || currentHour < 7);
      
      if (isNightTime) {
        frogElement.classList.add('night-mode');
        frogElement.style.cursor = 'not-allowed';
        frogElement.title = 'Клики доступны только с 07:00 до 22:00';
        frogElement.style.filter = 'brightness(0.7) grayscale(0.3) drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2))';
        
        // Отключаем кнопки и баннеры
        dailyRewardBtn.disabled = true;
        dailyRewardBtn.classList.add('night-mode-disabled');
        promoBtn.disabled = true;
        promoBtn.classList.add('night-mode-disabled');
        dailyRewardBanner.classList.add('night-mode-disabled');
        promoCodeItem.classList.add('night-mode-disabled');
        
        // Убираем существующие ночные уведомления
        const existingNotifications = document.querySelectorAll('.night-time-notification');
        existingNotifications.forEach(notification => notification.remove());
        
        // Создаем новое уведомление только если только что вошли в ночной режим
        if (!wasNightTime) {
          const nightNotification = document.createElement('div');
          nightNotification.className = 'night-time-notification';
          nightNotification.innerHTML = `
            <div class="night-time-icon">🌙</div>
            <div class="night-time-text">Ночное время</div>
            <div class="night-time-subtext">Клики доступны только с 07:00 до 22:00 по местному времени</div>
            <div class="night-time-current">
              Текущее время: ${now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
            </div>
          `;
          frogContainer.appendChild(nightNotification);
          
          // Убираем уведомление через 5 секунд
          setTimeout(() => {
            if (nightNotification.parentNode) {
              nightNotification.remove();
            }
          }, 5000);
        }
      } else {
        frogElement.classList.remove('night-mode');
        frogElement.style.cursor = 'pointer';
        frogElement.style.filter = 'drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2))';
        frogElement.title = '';
        
        // Включаем кнопки и баннеры
        dailyRewardBtn.disabled = false;
        dailyRewardBtn.classList.remove('night-mode-disabled');
        promoBtn.disabled = false;
        promoBtn.classList.remove('night-mode-disabled');
        dailyRewardBanner.classList.remove('night-mode-disabled');
        promoCodeItem.classList.remove('night-mode-disabled');
        
        // Убираем ночные уведомления если есть
        const nightNotifications = document.querySelectorAll('.night-time-notification');
        nightNotifications.forEach(notification => notification.remove());
      }
    }

    // Initialize the game
    function initGame() {
      loadGameData();
      updateUI();
      setupEventListeners();
      startTimerLoop();
      checkBanStatus();
      
      // Запускаем проверку времени сразу и каждую минуту
      checkTimeRestrictions();
      nightTimeCheckInterval = setInterval(checkTimeRestrictions, 60000); // Проверяем каждую минуту
      
      // Также проверяем каждую секунду для более точного отслеживания
      setInterval(checkTimeRestrictions, 1000);
      
      setTimeout(() => {
        checkForAvailableStars(true);
      }, 1000);
      
      // Add animation delays to stars cards
      document.querySelectorAll('.stars-card').forEach((card, index) => {
        card.style.setProperty('--i', index);
      });
      
      // Add animation delays to more items
      document.querySelectorAll('.more-item').forEach((item, index) => {
        item.style.setProperty('--i', index);
      });
      
      // Add animation delays to stat cards
      document.querySelectorAll('.stat-card').forEach((card, index) => {
        card.style.setProperty('--i', index);
      });
      
      // Add animation delays to receipt rows
      document.querySelectorAll('.receipt-row').forEach((row, index) => {
        row.style.setProperty('--i', index);
      });
      
      // Add animation delays to settings groups
      document.querySelectorAll('.settings-group').forEach((group, index) => {
        group.style.setProperty('--i', index);
      });
      
      // Apply animations setting
      applyAnimationsSetting();
      
      // Update click sessions display
      updateClickSessions();
    }

    // Load game data
    function loadGameData() {
      try {
        const savedClicks = localStorage.getItem('cvaptaClicks');
        const savedLastDailyReward = localStorage.getItem('cvaptaLastDailyReward');
        const savedUsedPromoCodes = localStorage.getItem('cvaptaUsedPromoCodes');
        const savedClickHistory = localStorage.getItem('cvaptaClickHistory');
        const savedTheme = localStorage.getItem('cvaptaTheme');
        const savedBanEndTime = localStorage.getItem('cvaptaBanEndTime');
        const savedTotalBans = localStorage.getItem('cvaptaTotalBans');
        const savedStarsRewards = localStorage.getItem('cvaptaStarsRewards');
        const savedWithdrawalHistory = localStorage.getItem('cvaptaWithdrawalHistory');
        const savedLastNotificationTime = localStorage.getItem('cvaptaLastNotificationTime');
        const savedAvailableStarsNotifications = localStorage.getItem('cvaptaAvailableStarsNotifications');
        const savedAnimationsEnabled = localStorage.getItem('cvaptaAnimationsEnabled');
        const savedClickSessions = localStorage.getItem('cvaptaClickSessions');
        
        if (savedClicks) clicks = parseInt(savedClicks) || 0;
        if (savedLastDailyReward) lastDailyReward = parseInt(savedLastDailyReward) || 0;
        if (savedUsedPromoCodes) usedPromoCodes = JSON.parse(savedUsedPromoCodes) || [];
        if (savedClickHistory) clickHistory = JSON.parse(savedClickHistory) || { daily: {}, weekly: {}, monthly: {} };
        if (savedTheme) {
          themeSelect.value = savedTheme;
          handleThemeChange();
        }
        if (savedBanEndTime) banEndTime = parseInt(savedBanEndTime) || 0;
        if (savedTotalBans) totalBans = parseInt(savedTotalBans) || 0;
        if (savedStarsRewards) starsRewards = JSON.parse(savedStarsRewards) || [
          { clicks: 60000, stars: 50 },
          { clicks: 110000, stars: 100 },
          { clicks: 160000, stars: 150 },
          { clicks: 210000, stars: 200 }
        ];
        if (savedWithdrawalHistory) withdrawalHistory = JSON.parse(savedWithdrawalHistory) || [];
        if (savedLastNotificationTime) lastNotificationTime = parseInt(savedLastNotificationTime) || 0;
        if (savedAvailableStarsNotifications) availableStarsNotifications = JSON.parse(savedAvailableStarsNotifications) || [];
        if (savedClickSessions) clickSessions = JSON.parse(savedClickSessions) || [];
        
        // Load animations setting
        if (savedAnimationsEnabled !== null) {
          animationsEnabled = savedAnimationsEnabled === 'true';
          if (animationsEnabled) {
            animationsToggle.classList.add('active');
            bodyElement.classList.remove('animations-disabled');
          } else {
            animationsToggle.classList.remove('active');
            bodyElement.classList.add('animations-disabled');
          }
        } else {
          animationsToggle.classList.add('active');
          bodyElement.classList.remove('animations-disabled');
          animationsEnabled = true;
        }
      } catch (error) {
        console.error('Error loading game data:', error);
        clicks = 0;
        lastDailyReward = 0;
        usedPromoCodes = [];
        clickHistory = { daily: {}, weekly: {}, monthly: {} };
        starsRewards = [
          { clicks: 60000, stars: 50 },
          { clicks: 110000, stars: 100 },
          { clicks: 160000, stars: 150 },
          { clicks: 210000, stars: 200 }
        ];
        withdrawalHistory = [];
        availableStarsNotifications = [];
        lastNotificationTime = 0;
        clickSessions = [];
        animationsEnabled = true;
      }
    }

    // Save game data
    function saveGameData() {
      try {
        localStorage.setItem('cvaptaClicks', clicks.toString());
        localStorage.setItem('cvaptaLastDailyReward', lastDailyReward.toString());
        localStorage.setItem('cvaptaUsedPromoCodes', JSON.stringify(usedPromoCodes));
        localStorage.setItem('cvaptaClickHistory', JSON.stringify(clickHistory));
        localStorage.setItem('cvaptaTheme', themeSelect.value);
        localStorage.setItem('cvaptaBanEndTime', banEndTime.toString());
        localStorage.setItem('cvaptaTotalBans', totalBans.toString());
        localStorage.setItem('cvaptaStarsRewards', JSON.stringify(starsRewards));
        localStorage.setItem('cvaptaWithdrawalHistory', JSON.stringify(withdrawalHistory));
        localStorage.setItem('cvaptaLastNotificationTime', lastNotificationTime.toString());
        localStorage.setItem('cvaptaAvailableStarsNotifications', JSON.stringify(availableStarsNotifications));
        localStorage.setItem('cvaptaAnimationsEnabled', animationsEnabled.toString());
        localStorage.setItem('cvaptaClickSessions', JSON.stringify(clickSessions));
      } catch (error) {
        console.error('Error saving game data:', error);
      }
    }

    // Update UI
    function updateUI() {
      clickCountElement.textContent = formatNumber(clicks);
      updateRewardButton();
      updateRewardTimers();
      updateStarsProgress();
    }

    // Format numbers
    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // Setup event listeners
    function setupEventListeners() {
      frogElement.addEventListener('click', handleFrogClick);
      
      settingsBtn.addEventListener('click', () => toggleModal(settingsModal));
      closeSettings.addEventListener('click', () => {
        toggleModal(settingsModal);
      });
      
      moreBtn.addEventListener('click', () => toggleModal(moreModal));
      closeMore.addEventListener('click', () => toggleModal(moreModal));
      
      dailyRewardBanner.addEventListener('click', () => {
        if (isNightTime) {
          showToast('Ночное время! Ежедневные награды доступны только с 07:00 до 22:00');
          return;
        }
        updateRewardTimers();
        toggleModal(dailyRewardModal);
      });
      closeDaily.addEventListener('click', () => {
        toggleModal(dailyRewardModal);
        // Возвращаемся в "Ещё"
        setTimeout(() => toggleModal(moreModal), 300);
      });
      
      promoCodeItem.addEventListener('click', () => {
        if (isNightTime) {
          showToast('Ночное время! Промокоды доступны только с 07:00 до 22:00');
          return;
        }
        toggleModal(promoCodeModal);
      });
      closePromo.addEventListener('click', () => {
        toggleModal(promoCodeModal);
        // Возвращаемся в "Ещё"
        setTimeout(() => toggleModal(moreModal), 300);
      });
      
      statsItem.addEventListener('click', () => {
        updateStatistics();
        updateStatisticsChart();
        updateClickSessions();
        toggleModal(statsModal);
      });
      closeStats.addEventListener('click', () => {
        toggleModal(statsModal);
        // ВОЗВРАЩАЕМСЯ В "ЕЩЁ" (исправлено!)
        setTimeout(() => toggleModal(moreModal), 300);
      });
      
      resetItem.addEventListener('click', () => toggleModal(resetModal));
      closeReset.addEventListener('click', () => {
        toggleModal(resetModal);
        // Возвращаемся в "Ещё"
        setTimeout(() => toggleModal(moreModal), 300);
      });
      
      starsItem.addEventListener('click', () => {
        updateStarsProgress();
        toggleModal(starsModal);
      });
      
      closeStars.addEventListener('click', () => {
        toggleModal(starsModal);
        // Возвращаемся в "Ещё"
        setTimeout(() => toggleModal(moreModal), 300);
      });
      
      starsHistoryBtn.addEventListener('click', () => {
        updateStarsHistory();
        toggleModal(starsHistoryModal);
      });
      
      closeStarsHistory.addEventListener('click', () => {
        toggleModal(starsHistoryModal);
        // При выходе из истории выводов переходим в основную вкладку звёзд
        setTimeout(() => {
          updateStarsProgress();
          toggleModal(starsModal);
        }, 300);
      });
      
      closeFullHistory.addEventListener('click', () => {
        toggleModal(fullHistoryModal);
        // Возвращаемся в статистику
        setTimeout(() => toggleModal(statsModal), 300);
      });
      
      starsWarningConfirm.addEventListener('click', processStarsWithdrawal);
      starsWarningCancel.addEventListener('click', () => {
        toggleModal(starsWarningModal);
        // Возвращаемся в звёзды
        setTimeout(() => toggleModal(starsModal), 300);
      });
      
      receiptCloseBtn.addEventListener('click', closeReceiptModal);
      
      animationsToggle.addEventListener('click', toggleAnimations);
      
      viewAllSessionsBtn.addEventListener('click', () => {
        updateFullHistory();
        toggleModal(fullHistoryModal);
      });
      
      document.querySelectorAll('.stars-card').forEach(card => {
        card.addEventListener('click', function() {
          if (this.classList.contains('locked')) {
            showToast('Недостаточно кликов для этой награды');
            return;
          }
          
          const rewardId = parseInt(this.dataset.reward);
          const requiredClicks = parseInt(this.dataset.clicks);
          const starsAmount = parseInt(this.dataset.stars);
          
          if (clicks >= requiredClicks) {
            showStarsWarning(rewardId, requiredClicks, starsAmount);
          } else {
            showToast('Недостаточно кликов для этой награды');
          }
        });
      });
      
      starsNotificationClose.addEventListener('click', hideStarsNotification);
      starsNotificationBtn.addEventListener('click', () => {
        hideStarsNotification();
        updateStarsProgress();
        toggleModal(starsModal);
      });
      
      themeSelect.addEventListener('change', handleThemeChange);
      
      document.querySelectorAll('.glass-modal').forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal && !isModalTransitioning) {
            const modalId = modal.id;
            
            // Обрабатываем закрытие только если не в процессе перехода
            if (modalId === 'stars-history-modal') {
              // При закрытии истории выводов переходим в звёзды
              isModalTransitioning = true;
              toggleModal(starsHistoryModal);
              setTimeout(() => {
                updateStarsProgress();
                toggleModal(starsModal);
                isModalTransitioning = false;
              }, 300);
            } else if (modalId === 'stars-warning-modal') {
              // При закрытии предупреждения возвращаемся в звёзды
              isModalTransitioning = true;
              toggleModal(starsWarningModal);
              setTimeout(() => {
                toggleModal(starsModal);
                isModalTransitioning = false;
              }, 300);
            } else if (modalId === 'stars-receipt-modal') {
              // При закрытии чека возвращаемся в звёзды
              isModalTransitioning = true;
              toggleModal(starsReceiptModal);
              setTimeout(() => {
                if (!currentReceiptContext || !currentReceiptContext.isFromHistory) {
                  toggleModal(starsModal);
                } else {
                  toggleModal(starsHistoryModal);
                }
                isModalTransitioning = false;
              }, 300);
            } else if (modalId === 'stars-modal') {
              // При закрытии звёзд возвращаемся в "Ещё"
              isModalTransitioning = true;
              toggleModal(starsModal);
              setTimeout(() => {
                toggleModal(moreModal);
                isModalTransitioning = false;
              }, 300);
            } else if (modalId === 'settings-modal') {
              // При закрытии настроек просто закрываем
              toggleModal(settingsModal);
            } else if (modalId === 'more-modal') {
              // При закрытии "Ещё" просто закрываем
              toggleModal(moreModal);
            } else {
              // Для всех остальных модальных окон возвращаемся в "Ещё"
              isModalTransitioning = true;
              toggleModal(modal);
              setTimeout(() => {
                toggleModal(moreModal);
                isModalTransitioning = false;
              }, 300);
            }
          }
        });
      });
      
      document.getElementById('promo-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          activatePromoCode();
        }
      });
    }

    // Handle frog click with anti-cheat and night time restriction
    function handleFrogClick(e) {
      if (isBanned) return;
      
      // Проверяем ночное время
      if (isNightTime) {
        showToast('Клики доступны только с 07:00 до 22:00 по местному времени');
        return;
      }
      
      if (antiCheatActive) {
        triggerBan(30 * 60 * 1000);
        return;
      }
      
      const now = Date.now();
      clickTimestamps.push(now);
      
      clickTimestamps = clickTimestamps.filter(timestamp => now - timestamp < 1000);
      
      if (clickTimestamps.length > MAX_CPS) {
        cheatDetectionCount++;
        
        if (cheatDetectionCount >= 3) {
          triggerAntiCheat();
        } else {
          showToast(`Предупреждение: Высокий CPS обнаружен! (${clickTimestamps.length}/с)`);
        }
      } else {
        if (cheatDetectionCount > 0) cheatDetectionCount--;
      }
      
      clicks++;
      totalSessionClicks++;
      
      updateClickHistory();
      
      // Обработка клик-сессии
      handleClickSession(now);
      
      if (activeEffects < MAX_EFFECTS && animationsEnabled) {
        createClickEffect(e);
        createFloatingText(e);
      }
      
      updateUI();
      saveGameData();
      
      checkForAvailableStars();
    }

    // Обработка клик-сессии
    function handleClickSession(clickTime) {
      if (!currentSession) {
        // Начало новой сессии
        currentSession = {
          startTime: clickTime,
          endTime: clickTime,
          clickCount: 1,
          clicksPerSecond: 0
        };
      } else {
        // Продолжение текущей сессии
        currentSession.endTime = clickTime;
        currentSession.clickCount++;
      }
      
      // Сбрасываем таймер завершения сессии
      if (sessionTimeout) {
        clearTimeout(sessionTimeout);
      }
      
      // Устанавливаем таймер завершения сессии (1 секунда паузы)
      sessionTimeout = setTimeout(() => {
        if (currentSession) {
          endCurrentSession();
        }
      }, SESSION_TIMEOUT);
    }
    
    // Завершение текущей сессии
    function endCurrentSession() {
      if (!currentSession || currentSession.clickCount <= 1) {
        currentSession = null;
        return;
      }
      
      const duration = (currentSession.endTime - currentSession.startTime) / 1000;
      currentSession.clicksPerSecond = duration > 0 ? currentSession.clickCount / duration : currentSession.clickCount;
      
      // Добавляем сессию в историю
      const sessionData = {
        ...currentSession,
        date: new Date().toISOString()
      };
      
      clickSessions.unshift(sessionData);
      
      // Сохраняем в localStorage
      saveGameData();
      
      // Обновляем отображение сессий
      updateClickSessions();
      
      // Сбрасываем текущую сессию
      currentSession = null;
    }

    // Update click history
    function updateClickHistory() {
      const now = new Date();
      const today = now.toDateString();
      const weekKey = getWeekKey(now);
      const monthKey = getMonthKey(now);
      
      if (!clickHistory.daily[today]) {
        clickHistory.daily[today] = 0;
      }
      clickHistory.daily[today]++;
      
      if (!clickHistory.weekly[weekKey]) {
        clickHistory.weekly[weekKey] = 0;
      }
      clickHistory.weekly[weekKey]++;
      
      if (!clickHistory.monthly[monthKey]) {
        clickHistory.monthly[monthKey] = 0;
      }
      clickHistory.monthly[monthKey]++;
    }
    
    function getWeekKey(date) {
      const d = new Date(date);
      d.setHours(0, 0, 0, 0);
      d.setDate(d.getDate() + 3 - (d.getDay() + 6) % 7);
      const week1 = new Date(d.getFullYear(), 0, 4);
      return d.getFullYear() + '-W' + Math.ceil(((d - week1) / 86400000 + 1) / 7);
    }
    
    function getMonthKey(date) {
      const d = new Date(date);
      return d.getFullYear() + '-' + (d.getMonth() + 1);
    }

    // Обновление отображения клик-сессий
    function updateClickSessions() {
      clickSessionsList.innerHTML = '';
      
      if (clickSessions.length === 0) {
        const emptyItem = document.createElement('div');
        emptyItem.className = 'click-session-item';
        emptyItem.innerHTML = `
          <div class="click-session-header">
            <div class="click-session-date">Нет сессий</div>
          </div>
          <div class="click-session-details">
            Ваши клик-сессии появятся здесь
          </div>
        `;
        clickSessionsList.appendChild(emptyItem);
        return;
      }
      
      // Отображаем только последние 3 сессии
      const recentSessions = clickSessions.slice(0, 3);
      
      recentSessions.forEach((session, index) => {
        const item = document.createElement('div');
        item.className = 'click-session-item';
        item.style.setProperty('--i', index);
        
        const date = new Date(session.date);
        const startTime = new Date(session.startTime);
        const endTime = new Date(session.endTime);
        const duration = (session.endTime - session.startTime) / 1000;
        const avgCPS = session.clicksPerSecond.toFixed(1);
        
        // Находим максимальное количество кликов в сессиях для прогресс-бара
        const maxClicks = Math.max(...clickSessions.map(s => s.clickCount), 1);
        const progressWidth = (session.clickCount / maxClicks) * 100;
        
        item.innerHTML = `
          <div class="click-session-header">
            <div class="click-session-date">${date.toLocaleDateString()} ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
            <div class="click-session-count">${formatNumber(session.clickCount)} кликов</div>
          </div>
          <div class="click-session-details">
            <div>Начало: ${startTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'})}</div>
            <div>Конец: ${endTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'})}</div>
          </div>
          <div class="click-session-duration">
            Длительность: ${duration.toFixed(1)} сек | CPS: ${avgCPS}
          </div>
          <div class="click-session-progress">
            <div class="click-session-progress-bar" style="width: ${progressWidth}%"></div>
          </div>
        `;
        
        clickSessionsList.appendChild(item);
      });
    }
    
    // Обновление полной истории
    function updateFullHistory() {
      fullHistoryList.innerHTML = '';
      totalSessionsCount.textContent = clickSessions.length;
      
      if (clickSessions.length === 0) {
        fullHistoryEmpty.style.display = 'block';
        return;
      }
      
      fullHistoryEmpty.style.display = 'none';
      
      // Находим максимальное количество кликов в сессиях для прогресс-бара
      const maxClicks = Math.max(...clickSessions.map(s => s.clickCount), 1);
      
      clickSessions.forEach((session, index) => {
        const item = document.createElement('div');
        item.className = 'click-session-item';
        item.style.setProperty('--i', index);
        
        const date = new Date(session.date);
        const startTime = new Date(session.startTime);
        const endTime = new Date(session.endTime);
        const duration = (session.endTime - session.startTime) / 1000;
        const avgCPS = session.clicksPerSecond.toFixed(1);
        
        const progressWidth = (session.clickCount / maxClicks) * 100;
        
        item.innerHTML = `
          <div class="click-session-header">
            <div class="click-session-date">${date.toLocaleDateString()} ${date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
            <div class="click-session-count">${formatNumber(session.clickCount)} кликов</div>
          </div>
          <div class="click-session-details">
            <div>Начало: ${startTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'})}</div>
            <div>Конец: ${endTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'})}</div>
          </div>
          <div class="click-session-duration">
            Длительность: ${duration.toFixed(1)} сек | CPS: ${avgCPS}
          </div>
          <div class="click-session-progress">
            <div class="click-session-progress-bar" style="width: ${progressWidth}%"></div>
          </div>
        `;
        
        fullHistoryList.appendChild(item);
      });
    }

    // Check for available stars
    function checkForAvailableStars(onLoad = false) {
      const now = Date.now();
      
      if (!onLoad && now - lastNotificationTime < NOTIFICATION_COOLDOWN) {
        return;
      }
      
      const availableRewards = starsRewards.filter((reward, index) => {
        const reached = clicks >= reward.clicks;
        const alreadyNotified = availableStarsNotifications.includes(index);
        return reached && !alreadyNotified;
      });
      
      if (availableRewards.length > 0) {
        const bestReward = availableRewards[0];
        const rewardIndex = starsRewards.findIndex(r => r.clicks === bestReward.clicks);
        
        showStarsNotification(bestReward.stars);
        
        availableStarsNotifications.push(rewardIndex);
        lastNotificationTime = now;
        saveGameData();
      }
    }
    
    // Show stars notification
    function showStarsNotification(starsAmount) {
      starsNotificationAmount.textContent = `${starsAmount} ⭐`;
      starsNotification.classList.add('show');
      
      setTimeout(() => {
        if (starsNotification.classList.contains('show')) {
          hideStarsNotification();
        }
      }, 10000);
    }
    
    // Hide stars notification
    function hideStarsNotification() {
      starsNotification.classList.remove('show');
    }

    // Create click effect
    function createClickEffect(e) {
      activeEffects++;
      
      const rect = frogElement.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const effect = document.createElement('div');
      effect.className = 'click-effect';
      effect.style.left = `${x}px`;
      effect.style.top = `${y}px`;
      
      frogElement.appendChild(effect);
      
      setTimeout(() => {
        effect.remove();
        activeEffects--;
      }, 400);
    }

    // Create floating text
    function createFloatingText(e) {
      activeEffects++;
      
      const rect = frogElement.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const text = document.createElement('div');
      text.className = 'floating-text';
      text.textContent = '+1';
      text.style.left = `${x}px`;
      text.style.top = `${y}px`;
      
      frogElement.appendChild(text);
      
      setTimeout(() => {
        text.remove();
        activeEffects--;
      }, 800);
    }

    // Toggle modal with smooth close
    function toggleModal(modal) {
      if (!modal) return;
      
      const isActive = modal.classList.contains('active');
      
      // Если модальное окно уже активно, просто закрываем его
      if (isActive) {
        modal.classList.add('closing');
        setTimeout(() => {
          modal.classList.remove('active', 'closing');
        }, 300);
      } else {
        // Сначала закрываем все другие активные модальные окна
        document.querySelectorAll('.glass-modal').forEach(m => {
          if (m !== modal && m.classList.contains('active')) {
            m.classList.add('closing');
            setTimeout(() => {
              m.classList.remove('active', 'closing');
            }, 300);
          }
        });
        
        // Затем открываем нужное модальное окно
        setTimeout(() => {
          modal.classList.add('active');
        }, 50); // Небольшая задержка для плавности
      }
    }

    // Update stars progress
    function updateStarsProgress() {
      starsRewards.forEach((reward, index) => {
        const card = document.getElementById(`stars-card-${index+1}`);
        const progressBar = document.getElementById(`stars-progress-${index+1}`);
        const currentText = document.getElementById(`stars-current-${index+1}`);
        
        if (!card || !progressBar || !currentText) return;
        
        const progress = Math.min(clicks / reward.clicks, 1);
        progressBar.style.width = `${progress * 100}%`;
        currentText.textContent = formatNumber(Math.min(clicks, reward.clicks));
        
        if (clicks >= reward.clicks) {
          card.classList.add('unlocked');
          card.classList.remove('locked');
        } else {
          card.classList.remove('unlocked');
          card.classList.add('locked');
        }
      });
    }

    // Show stars warning
    function showStarsWarning(rewardId, requiredClicks, starsAmount) {
      if (clicks < requiredClicks) {
        showToast('Недостаточно кликов для этой награды');
        return;
      }
      
      currentWithdrawal = { rewardId, requiredClicks, starsAmount };
      
      starsWarningConfirm.classList.remove('active');
      starsWarningConfirm.disabled = true;
      warningTimer.textContent = 'Пожалуйста, подождите 10 секунд...';
      
      if (warningTimerInterval) {
        clearInterval(warningTimerInterval);
      }
      
      let secondsLeft = 10;
      warningTimerInterval = setInterval(() => {
        secondsLeft--;
        warningTimer.textContent = `Пожалуйста, подождите ${secondsLeft} секунд${secondsLeft !== 1 ? '' : 'у'}`;
        
        if (secondsLeft <= 0) {
          clearInterval(warningTimerInterval);
          starsWarningConfirm.classList.add('active');
          starsWarningConfirm.disabled = false;
          warningTimer.textContent = 'Теперь можете продолжить';
        }
      }, 1000);
      
      toggleModal(starsWarningModal);
    }

    // Cancel stars withdrawal
    function cancelStarsWithdrawal() {
      if (warningTimerInterval) {
        clearInterval(warningTimerInterval);
        warningTimerInterval = null;
      }
      
      currentWithdrawal = null;
      
      toggleModal(starsWarningModal);
    }

    // Process stars withdrawal
    function processStarsWithdrawal() {
      if (!currentWithdrawal) return;
      
      const { rewardId, requiredClicks, starsAmount } = currentWithdrawal;
      
      if (clicks < requiredClicks) {
        showToast('Ошибка: недостаточно кликов');
        toggleModal(starsWarningModal);
        return;
      }
      
      if (warningTimerInterval) {
        clearInterval(warningTimerInterval);
        warningTimerInterval = null;
      }
      
      // Создаём запись в истории
      const withdrawalRecord = {
        id: 'W' + Date.now() + Math.floor(Math.random() * 1000),
        date: new Date().toISOString(),
        clicks: requiredClicks,
        stars: starsAmount,
        totalBans: totalBans,
        expiresAt: Date.now() + (3 * 24 * 60 * 60 * 1000)
      };
      
      withdrawalHistory.unshift(withdrawalRecord);
      
      // Сбрасываем клики
      clicks -= requiredClicks;
      if (clicks < 0) clicks = 0;
      
      // Обновляем UI и сохраняем
      updateUI();
      saveGameData();
      
      // Закрываем warning modal
      toggleModal(starsWarningModal);
      
      // Показываем чек
      setTimeout(() => {
        showReceipt(withdrawalRecord, false);
      }, 300);
      
      currentWithdrawal = null;
    }

    // Show receipt
    function showReceipt(record, isFromHistory = false) {
      const date = new Date(record.date);
      receiptIdElement.textContent = '#' + record.id;
      receiptDateElement.textContent = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
      receiptBansElement.textContent = record.totalBans;
      receiptClicksElement.textContent = formatNumber(record.clicks);
      receiptStarsElement.textContent = record.stars + ' ⭐';
      receiptTotalStarsElement.textContent = record.stars + ' ⭐';
      
      currentReceiptContext = { isFromHistory, record };
      
      if (receiptTimerInterval) {
        clearInterval(receiptTimerInterval);
        receiptTimerInterval = null;
      }
      
      if (isFromHistory) {
        receiptCloseBtn.classList.add('active');
        receiptCloseBtn.disabled = false;
        receiptCloseBtn.textContent = 'ЗАКРЫТЬ';
      } else {
        receiptCloseBtn.classList.remove('active');
        receiptCloseBtn.disabled = true;
        receiptCloseBtn.textContent = 'ЗАКРЫТЬ (Подождите 10 секунд...)';
        
        let secondsLeft = 10;
        receiptTimerInterval = setInterval(() => {
          secondsLeft--;
          receiptCloseBtn.textContent = `ЗАКРЫТЬ (Подождите ${secondsLeft} секунд${secondsLeft !== 1 ? '' : 'у'})`;
          
          if (secondsLeft <= 0) {
            clearInterval(receiptTimerInterval);
            receiptCloseBtn.classList.add('active');
            receiptCloseBtn.disabled = false;
            receiptCloseBtn.textContent = 'ЗАКРЫТЬ';
          }
        }, 1000);
      }
      
      toggleModal(starsReceiptModal);
    }

    // Close receipt modal
    function closeReceiptModal() {
      if (receiptTimerInterval) {
        clearInterval(receiptTimerInterval);
        receiptTimerInterval = null;
      }
      
      toggleModal(starsReceiptModal);
      
      if (!currentReceiptContext || !currentReceiptContext.isFromHistory) {
        toggleModal(starsModal);
        setTimeout(() => {
          window.open('https://t.me/Cvapik_bot', '_blank');
        }, 500);
      } else {
        // Если чек открыт из истории, возвращаемся в историю
        toggleModal(starsHistoryModal);
      }
      
      currentReceiptContext = null;
    }

    // Update stars history
    function updateStarsHistory() {
      starsHistoryList.innerHTML = '';
      
      const now = Date.now();
      withdrawalHistory = withdrawalHistory.filter(record => record.expiresAt > now);
      
      if (withdrawalHistory.length === 0) {
        starsHistoryEmpty.style.display = 'block';
        return;
      }
      
      starsHistoryEmpty.style.display = 'none';
      
      withdrawalHistory.forEach((record, index) => {
        const item = document.createElement('div');
        item.className = 'stars-history-item';
        item.style.setProperty('--i', index);
        
        const date = new Date(record.date);
        const expiresIn = Math.ceil((record.expiresAt - now) / (24 * 60 * 60 * 1000));
        
        item.innerHTML = `
          <div class="stars-history-header">
            <div class="stars-history-date">${date.toLocaleDateString()} ${date.toLocaleTimeString()}</div>
            <div class="stars-history-amount">${record.stars} ⭐</div>
          </div>
          <div class="stars-history-details">
            <div>Кликов: ${formatNumber(record.clicks)}</div>
            <div>ID: ${record.id}</div>
            <div>Банов: ${record.totalBans}</div>
            ${expiresIn <= 1 ? `<div class="stars-history-expired">⚠️ Истекает через ${expiresIn} день</div>` : ''}
          </div>
        `;
        
        item.addEventListener('click', () => {
          showReceipt(record, true);
        });
        
        starsHistoryList.appendChild(item);
      });
    }

    // Update reward button state
    function updateRewardButton() {
      const now = Date.now();
      const oneDay = 24 * 60 * 60 * 1000;
      const canClaim = (now - lastDailyReward) >= oneDay && !isNightTime;
      
      dailyRewardBtn.disabled = !canClaim;
      
      if (canClaim) {
        dailyRewardBtn.textContent = 'Получить 1000 кликов';
        dailyRewardBtn.classList.remove('night-mode-disabled');
      } else {
        dailyRewardBtn.textContent = isNightTime ? 'Ночное время' : 'Уже получено';
        if (isNightTime) {
          dailyRewardBtn.classList.add('night-mode-disabled');
        }
      }
    }

    // Update reward timers
    function updateRewardTimers() {
      const now = Date.now();
      const oneDay = 24 * 60 * 60 * 1000;
      const nextReward = lastDailyReward + oneDay;
      
      if (now < nextReward) {
        const timeLeft = nextReward - now;
        const hours = Math.floor(timeLeft / (60 * 60 * 1000));
        const minutes = Math.floor((timeLeft % (60 * 60 * 1000)) / (60 * 1000));
        const seconds = Math.floor((timeLeft % (60 * 1000)) / 1000);
        
        dailyRewardTimerElement.textContent = `Доступно через: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        rewardTimerElement.textContent = `Следующая награда через: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        rewardTimerElement.style.display = 'block';
      } else {
        dailyRewardTimerElement.textContent = 'Доступно сейчас!';
        rewardTimerElement.style.display = 'none';
      }
    }

    // Start timer loop
    function startTimerLoop() {
      setInterval(() => {
        updateRewardTimers();
        const now = Date.now();
        clickTimestamps = clickTimestamps.filter(timestamp => now - timestamp < 1000);
      }, 1000);
    }

    // Claim daily reward
    function claimDailyReward() {
      const now = Date.now();
      const oneDay = 24 * 60 * 60 * 1000;
      
      if ((now - lastDailyReward) < oneDay) {
        showToast('Уже получено сегодня!');
        return;
      }
      
      if (isNightTime) {
        showToast('Ночное время! Ежедневные награды доступны только с 07:00 до 22:00');
        return;
      }
      
      clicks += 1000;
      totalSessionClicks += 1000;
      lastDailyReward = now;
      
      const today = new Date().toDateString();
      if (!clickHistory.daily[today]) {
        clickHistory.daily[today] = 0;
      }
      clickHistory.daily[today] += 1000;
      
      updateUI();
      saveGameData();
      showToast('Ежедневная награда получена! +1000 кликов');
      toggleModal(dailyRewardModal);
    }

    // Activate promo code
    function activatePromoCode() {
      if (isNightTime) {
        showToast('Ночное время! Промокоды доступны только с 07:00 до 22:00');
        return;
      }
      
      const promoInput = document.getElementById('promo-input');
      const code = promoInput.value.trim().toUpperCase();
      
      if (!code) {
        showToast('Пожалуйста, введите промо-код');
        return;
      }
      
      if (usedPromoCodes.includes(code)) {
        showToast('Промо-код уже использован');
        return;
      }
      
      let reward = 0;
      
      switch(code) {
        case 'FROG250':
          reward = 250;
          break;
        case 'CLICK500':
          reward = 500;
          break;
        case 'GREEN1000':
          reward = 1000;
          break;
        case 'WELCOME':
          reward = 500;
          break;
        case 'COMEBACK':
          reward = 5000;
          break;
        case 'SPINA123':
          reward = 1000;
          break;
        case 'CVAPTA':
          reward = 200;
          break;
        default:
          showToast('Неверный промо-код');
          return;
      }
      
      clicks += reward;
      totalSessionClicks += reward;
      usedPromoCodes.push(code);
      promoInput.value = '';
      
      const today = new Date().toDateString();
      if (!clickHistory.daily[today]) {
        clickHistory.daily[today] = 0;
      }
      clickHistory.daily[today] += reward;
      
      updateUI();
      saveGameData();
      showToast(`Промо-код активирован! +${reward} кликов`);
    }

    // Update statistics
    function updateStatistics() {
      const today = new Date().toDateString();
      const todayClicks = clickHistory.daily[today] || 0;
      statTodayElement.textContent = formatNumber(todayClicks);
      
      const weekKey = getWeekKey(new Date());
      const weekClicks = clickHistory.weekly[weekKey] || 0;
      statWeekElement.textContent = formatNumber(weekClicks);
      
      const monthKey = getMonthKey(new Date());
      const monthClicks = clickHistory.monthly[monthKey] || 0;
      statMonthElement.textContent = formatNumber(monthClicks);
      
      const avgCPS = calculateAverageCPS();
      statAvgCPSElement.textContent = avgCPS.toFixed(1);
    }
    
    function calculateAverageCPS() {
      const sessionDuration = (Date.now() - sessionStartTime) / 1000;
      if (sessionDuration > 0) {
        return totalSessionClicks / sessionDuration;
      }
      return 0;
    }
    
    function updateStatisticsChart() {
      statsChartElement.innerHTML = '';
      
      const data = [];
      const labels = [];
      const today = new Date();
      
      for (let i = 6; i >= 0; i--) {
        const date = new Date();
        date.setDate(today.getDate() - i);
        const dateString = date.toDateString();
        const dayName = getShortDayName(date.getDay());
        const dateNum = date.getDate();
        
        data.push(clickHistory.daily[dateString] || 0);
        labels.push(`${dayName}\n${dateNum}`);
      }
      
      const maxValue = Math.max(...data, 1);
      const chartHeight = 80;
      
      data.forEach((value, index) => {
        const barContainer = document.createElement('div');
        barContainer.className = 'chart-bar-container';
        barContainer.style.setProperty('--i', index);
        
        const bar = document.createElement('div');
        bar.className = 'chart-bar';
        const barHeight = maxValue > 0 ? (value / maxValue) * chartHeight : 2;
        bar.style.height = `${barHeight}px`;
        
        const dayLabel = document.createElement('div');
        dayLabel.className = 'chart-label';
        dayLabel.textContent = labels[index];
        
        barContainer.appendChild(bar);
        barContainer.appendChild(dayLabel);
        statsChartElement.appendChild(barContainer);
      });
    }
    
    function getShortDayName(dayIndex) {
      const days = ['В', 'П', 'В', 'С', 'Ч', 'П', 'С'];
      return days[dayIndex];
    }

    // Reset progress
    function resetProgress() {
      if (confirm('Вы уверены, что хотите сбросить весь прогресс? Это действие нельзя отменить!')) {
        clicks = 0;
        lastDailyReward = 0;
        usedPromoCodes = [];
        totalSessionClicks = 0;
        totalBans = 0;
        sessionStartTime = Date.now();
        clickHistory = {
          daily: {},
          weekly: {},
          monthly: {}
        };
        withdrawalHistory = [];
        availableStarsNotifications = [];
        lastNotificationTime = 0;
        clickTimestamps = [];
        cheatDetectionCount = 0;
        clickSessions = []; // Очищаем историю сессий
        if (currentSession) {
          currentSession = null;
        }
        if (sessionTimeout) {
          clearTimeout(sessionTimeout);
          sessionTimeout = null;
        }
        
        updateUI();
        updateClickSessions();
        saveGameData();
        hideStarsNotification();
        showToast('Прогресс успешно сброшен');
        toggleModal(resetModal);
      }
    }

    // Handle theme change
    function handleThemeChange() {
      const theme = themeSelect.value;
      
      if (theme === 'light') {
        bodyElement.classList.remove('dark-theme', 'pink-theme');
        bodyElement.classList.add('light-theme');
      } else if (theme === 'pink') {
        bodyElement.classList.remove('dark-theme', 'light-theme');
        bodyElement.classList.add('pink-theme');
      } else {
        bodyElement.classList.remove('light-theme', 'pink-theme');
        bodyElement.classList.add('dark-theme');
      }
      
      saveGameData();
    }

    // Toggle animations
    function toggleAnimations() {
      animationsEnabled = !animationsEnabled;
      
      if (animationsEnabled) {
        animationsToggle.classList.add('active');
        bodyElement.classList.remove('animations-disabled');
      } else {
        animationsToggle.classList.remove('active');
        bodyElement.classList.add('animations-disabled');
      }
      
      saveGameData();
      showToast(animationsEnabled ? 'Улучшение анимаций включено' : 'Улучшение анимаций выключено');
    }
    
    // Apply animations setting
    function applyAnimationsSetting() {
      if (animationsEnabled) {
        bodyElement.classList.remove('animations-disabled');
      } else {
        bodyElement.classList.add('animations-disabled');
      }
    }

    // Show toast message
    function showToast(message) {
      toastElement.textContent = message;
      toastElement.classList.add('show');
      
      setTimeout(() => {
        toastElement.classList.remove('show');
      }, 3000);
    }

    // Anti-Cheat Functions
    function triggerAntiCheat() {
      antiCheatActive = true;
      antiCheatOverlay.classList.add('active');
      antiCheatMessage.style.display = 'block';
      cheaterDetected.style.display = 'none';
      banTimer.style.display = 'none';
      
      document.addEventListener('click', handleAntiCheatClick, true);
      
      setTimeout(() => {
        if (antiCheatActive) {
          antiCheatActive = false;
          antiCheatOverlay.classList.remove('active');
          document.removeEventListener('click', handleAntiCheatClick, true);
          showToast('Проверка анти-чита пройдена');
        }
      }, 5000);
    }
    
    function handleAntiCheatClick(e) {
      e.stopPropagation();
      e.preventDefault();
      triggerBan(30 * 60 * 1000);
    }
    
    function triggerBan(duration) {
      isBanned = true;
      banEndTime = Date.now() + duration;
      antiCheatActive = false;
      
      totalBans++;
      saveGameData();
      
      antiCheatOverlay.classList.add('active');
      antiCheatMessage.style.display = 'none';
      cheaterDetected.style.display = 'block';
      banTimer.style.display = 'block';
      
      updateBanTimer();
      const banInterval = setInterval(updateBanTimer, 1000);
      
      function updateBanTimer() {
        const now = Date.now();
        const remaining = banEndTime - now;
        
        if (remaining <= 0) {
          isBanned = false;
          antiCheatOverlay.classList.remove('active');
          clearInterval(banInterval);
          showToast('Бан снят. Вы можете играть снова.');
          return;
        }
        
        const minutes = Math.floor(remaining / 60000);
        const seconds = Math.floor((remaining % 60000) / 1000);
        banTimeElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
      }
    }
    
    function checkBanStatus() {
      if (banEndTime > Date.now()) {
        triggerBan(banEndTime - Date.now());
      }
    }

    // Initialize game when page loads
    document.addEventListener('DOMContentLoaded', initGame);
  </script>
</body>
</html>